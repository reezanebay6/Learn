<!DOCTYPE html>
<!-- saved from url=(0121)https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr" xmlns:fb="http://ogp.me/ns/fb#" xmlns:og="http://ogp.me/ns#" xmlns:article="http://ogp.me/ns/article#" xmlns:book="http://ogp.me/ns/book#" xmlns:profile="http://ogp.me/ns/profile#" xmlns:video="http://ogp.me/ns/video#" xmlns:product="http://ogp.me/ns/product#" class="js"><head profile="http://www.w3.org/1999/xhtml/vocab"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="HandheldFriendly" content="true">
  <meta name="viewport" content="width=device-width">
  <meta name="MobileOptimized" content="width">
  <!--[if IE]><![endif]-->
<link rel="preconnect" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
<link rel="dns-prefetch" href="https://fonts.gstatic.com/">
<link rel="dns-prefetch" href="https://www.google-analytics.com/">
<link rel="preconnect" href="https://www.google-analytics.com/">
<link rel="dns-prefetch" href="https://stats.g.doubleclick.net/">
<link rel="preconnect" href="https://stats.g.doubleclick.net/">
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/e671e25255"></script><script src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/nr-1130.min.js"></script><script type="text/javascript" async="" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/insight.min.js"></script><script src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/inferredEvents.js" async=""></script><script src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/576466256018464" async=""></script><script async="" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/fbevents.js"></script><script async="" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/uwt.js"></script><script type="text/javascript" async="" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/54419274f6c96ed073000003.js"></script><script async="" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/init.js"></script><script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"XAcEV19XGwcCUldTDwg="};window.NREUM||(NREUM={}),__nr_require=function(t,n,e){function r(e){if(!n[e]){var o=n[e]={exports:{}};t[e][0].call(o.exports,function(n){var o=t[e][1][n];return r(o||n)},o,o.exports)}return n[e].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({1:[function(t,n,e){function r(t){try{s.console&&console.log(t)}catch(n){}}var o,i=t("ee"),a=t(18),s={};try{o=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(s.console=!0,o.indexOf("dev")!==-1&&(s.dev=!0),o.indexOf("nr_dev")!==-1&&(s.nrDev=!0))}catch(c){}s.nrDev&&i.on("internal-error",function(t){r(t.stack)}),s.dev&&i.on("fn-err",function(t,n,e){r(e.stack)}),s.dev&&(r("NR AGENT IN DEVELOPMENT MODE"),r("flags: "+a(s,function(t,n){return t}).join(", ")))},{}],2:[function(t,n,e){function r(t,n,e,r,s){try{p?p-=1:o(s||new UncaughtException(t,n,e),!0)}catch(f){try{i("ierr",[f,c.now(),!0])}catch(d){}}return"function"==typeof u&&u.apply(this,a(arguments))}function UncaughtException(t,n,e){this.message=t||"Uncaught error with no additional information",this.sourceURL=n,this.line=e}function o(t,n){var e=n?null:c.now();i("err",[t,e])}var i=t("handle"),a=t(19),s=t("ee"),c=t("loader"),f=t("gos"),u=window.onerror,d=!1,l="nr@seenError",p=0;c.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(h){"stack"in h&&(t(8),t(7),"addEventListener"in window&&t(5),c.xhrWrappable&&t(9),d=!0)}s.on("fn-start",function(t,n,e){d&&(p+=1)}),s.on("fn-err",function(t,n,e){d&&!e[l]&&(f(e,l,function(){return!0}),this.thrown=!0,o(e))}),s.on("fn-end",function(){d&&!this.thrown&&p>0&&(p-=1)}),s.on("internal-error",function(t){i("ierr",[t,c.now(),!0])})},{}],3:[function(t,n,e){t("loader").features.ins=!0},{}],4:[function(t,n,e){function r(t){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var o=t("ee"),i=t("handle"),a=t(8),s=t(7),c="learResourceTimings",f="addEventListener",u="resourcetimingbufferfull",d="bstResource",l="resource",p="-start",h="-end",m="fn"+p,w="fn"+h,v="bstTimer",y="pushState",g=t("loader");g.features.stn=!0,t(6);var x=NREUM.o.EV;o.on(m,function(t,n){var e=t[0];e instanceof x&&(this.bstStart=g.now())}),o.on(w,function(t,n){var e=t[0];e instanceof x&&i("bst",[e,n,this.bstStart,g.now()])}),a.on(m,function(t,n,e){this.bstStart=g.now(),this.bstType=e}),a.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),this.bstType])}),s.on(m,function(){this.bstStart=g.now()}),s.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),"requestAnimationFrame"])}),o.on(y+p,function(t){this.time=g.now(),this.startPath=location.pathname+location.hash}),o.on(y+h,function(t){i("bstHist",[location.pathname+location.hash,this.startPath,this.time])}),f in window.performance&&(window.performance["c"+c]?window.performance[f](u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["c"+c]()},!1):window.performance[f]("webkit"+u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["webkitC"+c]()},!1)),document[f]("scroll",r,{passive:!0}),document[f]("keypress",r,!1),document[f]("click",r,!1)}},{}],5:[function(t,n,e){function r(t){for(var n=t;n&&!n.hasOwnProperty(u);)n=Object.getPrototypeOf(n);n&&o(n)}function o(t){s.inPlace(t,[u,d],"-",i)}function i(t,n){return t[1]}var a=t("ee").get("events"),s=t(21)(a,!0),c=t("gos"),f=XMLHttpRequest,u="addEventListener",d="removeEventListener";n.exports=a,"getPrototypeOf"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+"-start",function(t,n){var e=t[1],r=c(e,"nr@wrapped",function(){function t(){if("function"==typeof e.handleEvent)return e.handleEvent.apply(e,arguments)}var n={object:t,"function":e}[typeof e];return n?s(n,"fn-",null,n.name||"anonymous"):e});this.wrapped=t[1]=r}),a.on(d+"-start",function(t){t[1]=this.wrapped||t[1]})},{}],6:[function(t,n,e){var r=t("ee").get("history"),o=t(21)(r);n.exports=r;var i=window.history&&window.history.constructor&&window.history.constructor.prototype,a=window.history;i&&i.pushState&&i.replaceState&&(a=i),o.inPlace(a,["pushState","replaceState"],"-")},{}],7:[function(t,n,e){var r=t("ee").get("raf"),o=t(21)(r),i="equestAnimationFrame";n.exports=r,o.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),r.on("raf-start",function(t){t[0]=o(t[0],"fn-")})},{}],8:[function(t,n,e){function r(t,n,e){t[0]=a(t[0],"fn-",null,e)}function o(t,n,e){this.method=e,this.timerDuration=isNaN(t[1])?0:+t[1],t[0]=a(t[0],"fn-",this,e)}var i=t("ee").get("timer"),a=t(21)(i),s="setTimeout",c="setInterval",f="clearTimeout",u="-start",d="-";n.exports=i,a.inPlace(window,[s,"setImmediate"],s+d),a.inPlace(window,[c],c+d),a.inPlace(window,[f,"clearImmediate"],f+d),i.on(c+u,r),i.on(s+u,o)},{}],9:[function(t,n,e){function r(t,n){d.inPlace(n,["onreadystatechange"],"fn-",s)}function o(){var t=this,n=u.context(t);t.readyState>3&&!n.resolved&&(n.resolved=!0,u.emit("xhr-resolved",[],t)),d.inPlace(t,y,"fn-",s)}function i(t){g.push(t),h&&(b?b.then(a):w?w(a):(E=-E,R.data=E))}function a(){for(var t=0;t<g.length;t++)r([],g[t]);g.length&&(g=[])}function s(t,n){return n}function c(t,n){for(var e in t)n[e]=t[e];return n}t(5);var f=t("ee"),u=f.get("xhr"),d=t(21)(u),l=NREUM.o,p=l.XHR,h=l.MO,m=l.PR,w=l.SI,v="readystatechange",y=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],g=[];n.exports=u;var x=window.XMLHttpRequest=function(t){var n=new p(t);try{u.emit("new-xhr",[n],n),n.addEventListener(v,o,!1)}catch(e){try{u.emit("internal-error",[e])}catch(r){}}return n};if(c(p,x),x.prototype=p.prototype,d.inPlace(x.prototype,["open","send"],"-xhr-",s),u.on("send-xhr-start",function(t,n){r(t,n),i(n)}),u.on("open-xhr-start",r),h){var b=m&&m.resolve();if(!w&&!m){var E=1,R=document.createTextNode(E);new h(a).observe(R,{characterData:!0})}}else f.on("fn-end",function(t){t[0]&&t[0].type===v||a()})},{}],10:[function(t,n,e){function r(){var t=window.NREUM,n=t.info.accountID||null,e=t.info.agentID||null,r=t.info.trustKey||null,i="btoa"in window&&"function"==typeof window.btoa;if(!n||!e||!i)return null;var a={v:[0,1],d:{ty:"Browser",ac:n,ap:e,id:o.generateCatId(),tr:o.generateCatId(),ti:Date.now()}};return r&&n!==r&&(a.d.tk=r),btoa(JSON.stringify(a))}var o=t(16);n.exports={generateTraceHeader:r}},{}],11:[function(t,n,e){function r(t){var n=this.params,e=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<p;r++)t.removeEventListener(l[r],this.listener,!1);n.aborted||(e.duration=s.now()-this.startTime,this.loadCaptureCalled||4!==t.readyState?null==n.status&&(n.status=0):a(this,t),e.cbTime=this.cbTime,d.emit("xhr-done",[t],t),c("xhr",[n,e,this.startTime]))}}function o(t,n){var e=t.responseType;if("json"===e&&null!==n)return n;var r="arraybuffer"===e||"blob"===e||"json"===e?t.response:t.responseText;return w(r)}function i(t,n){var e=f(n),r=t.params;r.host=e.hostname+":"+e.port,r.pathname=e.pathname,t.sameOrigin=e.sameOrigin}function a(t,n){t.params.status=n.status;var e=o(n,t.lastSize);if(e&&(t.metrics.rxSize=e),t.sameOrigin){var r=n.getResponseHeader("X-NewRelic-App-Data");r&&(t.params.cat=r.split(", ").pop())}t.loadCaptureCalled=!0}var s=t("loader");if(s.xhrWrappable){var c=t("handle"),f=t(12),u=t(10).generateTraceHeader,d=t("ee"),l=["load","error","abort","timeout"],p=l.length,h=t("id"),m=t(15),w=t(14),v=window.XMLHttpRequest;s.features.xhr=!0,t(9),d.on("new-xhr",function(t){var n=this;n.totalCbs=0,n.called=0,n.cbTime=0,n.end=r,n.ended=!1,n.xhrGuids={},n.lastSize=null,n.loadCaptureCalled=!1,t.addEventListener("load",function(e){a(n,t)},!1),m&&(m>34||m<10)||window.opera||t.addEventListener("progress",function(t){n.lastSize=t.loaded},!1)}),d.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),d.on("open-xhr-end",function(t,n){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&n.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid);var e=!1;if("init"in NREUM&&"distributed_tracing"in NREUM.init&&(e=!!NREUM.init.distributed_tracing.enabled),e&&this.sameOrigin){var r=u();r&&n.setRequestHeader("newrelic",r)}}),d.on("send-xhr-start",function(t,n){var e=this.metrics,r=t[0],o=this;if(e&&r){var i=w(r);i&&(e.txSize=i)}this.startTime=s.now(),this.listener=function(t){try{"abort"!==t.type||o.loadCaptureCalled||(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof n.onload))&&o.end(n)}catch(e){try{d.emit("internal-error",[e])}catch(r){}}};for(var a=0;a<p;a++)n.addEventListener(l[a],this.listener,!1)}),d.on("xhr-cb-time",function(t,n,e){this.cbTime+=t,n?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof e.onload||this.end(e)}),d.on("xhr-load-added",function(t,n){var e=""+h(t)+!!n;this.xhrGuids&&!this.xhrGuids[e]&&(this.xhrGuids[e]=!0,this.totalCbs+=1)}),d.on("xhr-load-removed",function(t,n){var e=""+h(t)+!!n;this.xhrGuids&&this.xhrGuids[e]&&(delete this.xhrGuids[e],this.totalCbs-=1)}),d.on("addEventListener-end",function(t,n){n instanceof v&&"load"===t[0]&&d.emit("xhr-load-added",[t[1],t[2]],n)}),d.on("removeEventListener-end",function(t,n){n instanceof v&&"load"===t[0]&&d.emit("xhr-load-removed",[t[1],t[2]],n)}),d.on("fn-start",function(t,n,e){n instanceof v&&("onload"===e&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=s.now()))}),d.on("fn-end",function(t,n){this.xhrCbStart&&d.emit("xhr-cb-time",[s.now()-this.xhrCbStart,this.onload,n],n)})}},{}],12:[function(t,n,e){n.exports=function(t){var n=document.createElement("a"),e=window.location,r={};n.href=t,r.port=n.port;var o=n.href.split("://");!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=n.hostname||e.hostname,r.pathname=n.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var i=!n.protocol||":"===n.protocol||n.protocol===e.protocol,a=n.hostname===document.domain&&n.port===e.port;return r.sameOrigin=i&&(!n.hostname||a),r}},{}],13:[function(t,n,e){function r(){}function o(t,n,e){return function(){return i(t,[f.now()].concat(s(arguments)),n?null:this,e),n?void 0:this}}var i=t("handle"),a=t(18),s=t(19),c=t("ee").get("tracer"),f=t("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",p=l+"ixn-";a(d,function(t,n){u[n]=o(l+n,!0,"api")}),u.addPageAction=o(l+"addPageAction",!0),u.setCurrentRouteName=o(l+"routeName",!0),n.exports=newrelic,u.interaction=function(){return(new r).get()};var h=r.prototype={createTracer:function(t,n){var e={},r=this,o="function"==typeof n;return i(p+"tracer",[f.now(),t,e],r),function(){if(c.emit((o?"":"no-")+"fn-start",[f.now(),r,o],e),o)try{return n.apply(this,arguments)}catch(t){throw c.emit("fn-err",[arguments,this,t],e),t}finally{c.emit("fn-end",[f.now()],e)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,n){h[n]=o(p+n)}),newrelic.noticeError=function(t,n){"string"==typeof t&&(t=new Error(t)),i("err",[t,f.now(),!1,n])}},{}],14:[function(t,n,e){n.exports=function(t){if("string"==typeof t&&t.length)return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!("undefined"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(n){return}}}},{}],15:[function(t,n,e){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o&&(r=+o[1]),n.exports=r},{}],16:[function(t,n,e){function r(){function t(){return n?15&n[e++]:16*Math.random()|0}var n=null,e=0,r=window.crypto||window.msCrypto;r&&r.getRandomValues&&(n=r.getRandomValues(new Uint8Array(31)));for(var o,i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",a="",s=0;s<i.length;s++)o=i[s],"x"===o?a+=t().toString(16):"y"===o?(o=3&t()|8,a+=o.toString(16)):a+=o;return a}function o(){function t(){return n?15&n[e++]:16*Math.random()|0}var n=null,e=0,r=window.crypto||window.msCrypto;r&&r.getRandomValues&&Uint8Array&&(n=r.getRandomValues(new Uint8Array(31)));for(var o=[],i=0;i<16;i++)o.push(t().toString(16));return o.join("")}n.exports={generateUuid:r,generateCatId:o}},{}],17:[function(t,n,e){function r(t,n){if(!o)return!1;if(t!==o)return!1;if(!n)return!0;if(!i)return!1;for(var e=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==e[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var s=navigator.userAgent,c=s.match(a);c&&s.indexOf("Chrome")===-1&&s.indexOf("Chromium")===-1&&(o="Safari",i=c[1])}n.exports={agent:o,version:i,match:r}},{}],18:[function(t,n,e){function r(t,n){var e=[],r="",i=0;for(r in t)o.call(t,r)&&(e[i]=n(r,t[r]),i+=1);return e}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],19:[function(t,n,e){function r(t,n,e){n||(n=0),"undefined"==typeof e&&(e=t?t.length:0);for(var r=-1,o=e-n||0,i=Array(o<0?0:o);++r<o;)i[r]=t[n+r];return i}n.exports=r},{}],20:[function(t,n,e){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],21:[function(t,n,e){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t("ee"),i=t(19),a="nr@original",s=Object.prototype.hasOwnProperty,c=!1;n.exports=function(t,n){function e(t,n,e,o){function nrWrapper(){var r,a,s,c;try{a=this,r=i(arguments),s="function"==typeof e?e(r,a):e||{}}catch(f){l([f,"",[r,a,o],s])}u(n+"start",[r,a,o],s);try{return c=t.apply(a,r)}catch(d){throw u(n+"err",[r,a,d],s),d}finally{u(n+"end",[r,a,c],s)}}return r(t)?t:(n||(n=""),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,n,o,i){o||(o="");var a,s,c,f="-"===o.charAt(0);for(c=0;c<n.length;c++)s=n[c],a=t[s],r(a)||(t[s]=e(a,f?s+o:o,i,s))}function u(e,r,o){if(!c||n){var i=c;c=!0;try{t.emit(e,r,o,n)}catch(a){l([a,e,r,o])}c=i}}function d(t,n){if(Object.defineProperty&&Object.keys)try{var e=Object.keys(t);return e.forEach(function(e){Object.defineProperty(n,e,{get:function(){return t[e]},set:function(n){return t[e]=n,n}})}),n}catch(r){l([r])}for(var o in t)s.call(t,o)&&(n[o]=t[o]);return n}function l(n){try{t.emit("internal-error",n)}catch(e){}}return t||(t=o),e.inPlace=f,e.flag=a,e}},{}],ee:[function(t,n,e){function r(){}function o(t){function n(t){return t&&t instanceof r?t:t?c(t,s,i):i()}function e(e,r,o,i){if(!l.aborted||i){t&&t(e,r,o);for(var a=n(o),s=m(e),c=s.length,f=0;f<c;f++)s[f].apply(a,r);var d=u[g[e]];return d&&d.push([x,e,r,a]),a}}function p(t,n){y[t]=m(t).concat(n)}function h(t,n){var e=y[t];if(e)for(var r=0;r<e.length;r++)e[r]===n&&e.splice(r,1)}function m(t){return y[t]||[]}function w(t){return d[t]=d[t]||o(e)}function v(t,n){f(t,function(t,e){n=n||"feature",g[e]=n,n in u||(u[n]=[])})}var y={},g={},x={on:p,addEventListener:p,removeEventListener:h,emit:e,get:w,listeners:m,context:n,buffer:v,abort:a,aborted:!1};return x}function i(){return new r}function a(){(u.api||u.feature)&&(l.aborted=!0,u=l.backlog={})}var s="nr@context",c=t("gos"),f=t(18),u={},d={},l=n.exports=o();l.backlog=u},{}],gos:[function(t,n,e){function r(t,n,e){if(o.call(t,n))return t[n];var r=e();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(t,n,e){function r(t,n,e,r){o.buffer([t],r),o.emit(t,n,e)}var o=t("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(t,n,e){function r(t){var n=typeof t;return!t||"object"!==n&&"function"!==n?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i="nr@id",a=t("gos");n.exports=r},{}],loader:[function(t,n,e){function r(){if(!E++){var t=b.info=NREUM.info,n=p.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&n))return u.abort();f(g,function(n,e){t[n]||(t[n]=e)}),c("mark",["onload",a()+b.offset],null,"api");var e=p.createElement("script");e.src="https://"+t.agent,n.parentNode.insertBefore(e,n)}}function o(){"complete"===p.readyState&&i()}function i(){c("mark",["domContent",a()+b.offset],null,"api")}function a(){return R.exists&&performance.now?Math.round(performance.now()):(s=Math.max((new Date).getTime(),s))-b.offset}var s=(new Date).getTime(),c=t("handle"),f=t(18),u=t("ee"),d=t(17),l=window,p=l.document,h="addEventListener",m="attachEvent",w=l.XMLHttpRequest,v=w&&w.prototype;NREUM.o={ST:setTimeout,SI:l.setImmediate,CT:clearTimeout,XHR:w,REQ:l.Request,EV:l.Event,PR:l.Promise,MO:l.MutationObserver};var y=""+location,g={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1130.min.js"},x=w&&v&&v[h]&&!/CriOS/.test(navigator.userAgent),b=n.exports={offset:s,now:a,origin:y,features:{},xhrWrappable:x,userAgent:d};t(13),p[h]?(p[h]("DOMContentLoaded",i,!1),l[h]("load",r,!1)):(p[m]("onreadystatechange",o),l[m]("onload",r)),c("mark",["firstbyte",s],null,"api");var E=0,R=t(20)},{}]},{},["loader",2,11,4,3]);</script>
<meta name="description" content="Settings can be deployed only once when rolled into code and put in an update hook in the .install file of a custom module.">
<meta name="generator" content="Drupal 7 (https://www.drupal.org)">
<link rel="canonical" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how">
<link rel="shortlink" href="https://www.drupal.org/node/2854170">
<meta property="og:site_name" content="Drupal.org">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how">
<meta property="og:title" content="Examples for database update scripts using hook_update_N (how to do one time configuration programmatically)">
<meta property="og:description" content="Contents of this page Concept Create a custom database update module How to &quot;revert&quot; a custom module&#39;s update &#39;N value&#39; How to purge the .install field when it becomes too long What if you run out of numbers?">
<meta property="og:updated_time" content="2019-08-08T07:39:29+00:00">
<meta property="article:published_time" content="2017-02-20T13:10:38+00:00">
<meta property="article:modified_time" content="2019-08-08T07:39:29+00:00">
  <title>Examples for database update scripts using hook_update_N (how&nbsp;to do one time configuration programmatically) | Drupal 7 guide on Drupal.org</title>
  <link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__BJ6Ou6QsBRtnFTmxaakamOIS8n4QswDP2XnnZ1sxtaM__NBuvkP6eInGIkb1aJvUHx5PX79XApuxBDkk_77W5tYk__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__pb75Es3Qz_6dc5qRXFfBteLW3eKMf92-wDXx91C4Sts__x4ZhO-JDmwub5A-5im8235wCAhkc5qH6jmjVPMhMrYc__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="screen">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__rxlkNswgFNTxNaSPriAIXx4ZlwBOB3RlBPezSG6R9_M__VHgdJ4r9tHl_YrvPjndJ9qh877SF9D0BV0kuzFGik7Y__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css___gHaOfUPGMp9CmQToCayUOFNYCWkA0HSxl7r-Dtt9XI__lDrzWssmRvNcI9hewNcBnrsFz4QXcfZIDU6MaYNjq9k__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__VB5ewlXzRLK9G8c-SdackBhY4Kx6j7ZyCsGRWIjDFGo__qe-bB54HYzCh2FGCe62WdrVkshNF02DQLj9u3C7yZR4__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__rQ1alF2wtRJheC4MwbTGQHhDW1u3JWtM73MeXej8ZCI__p-VwQIrVeejdBOjfXDxhLZnsUhKi1r9hCeECIryJwZU__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="screen">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__P6IUplZtg49jjx07vmYslkCOrJk37PuZ8DFTyLCIKxA__8WLLw30TFGwdXXi2OebbkVNSWKTWS5dEWLp7rfHtS28__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__8f1mYXI7glGDMs7Bx9TxdVZ8Q_aBetDl5aUglGDF004__-2CRiB16jOVlO1XcWAWhaWWluW3Lxo4Jhywz0oIiHkk__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__IND9Ea9cZJoyPbSkNshnqYv4c5MRWiCE06f8uY8qHPM__P6MQmonPAG9EwAkymq3qjeHUqjIQEfCps7JxljLqlUY__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__TfWyVKLagmeJkncT3LJJUcy3ESr1XKJqq3qz5tUtuGU__bQx6iO0FF7UXuwKRSbHWGshBIcB7PlbuJGcaPCIKHf4__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__v9yeCzgz7qs8Fbr-QWlDypB0PqI80y3jvDguhVToBCA__peMydGxnw5J-npl9TiHeBlNB52l8AUr_JLg6cBT-Ou4__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__vxxEWlql3uJOE6SxuswbSiGtjIUhlDGIEtXZIFy_4eA__nNAOKTKr_LLqGP0bgthGYh0vhAdtTU46IXmZBInTCAg__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__eFKSCujfWyJYO8J-qSi6T_n29lROS8isvrxzANeHaAY__D_EUHDAfEQdxcLiSDY7hREUWkG1Ge56_h2z3Er8V188__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__mXUsFOkFX1Vp3cPaBtPrMNLiyy4rOzIAVz7DppnovsY__4a32sD5wTTMzrJf7XqA8yck7wVaHdAmb-RLMBilVXyY__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__WF0PRotZAhCcl0aJjY5W2LYj8UwiYuB2dZEFluOh3Tc__FviX13FUB-Ppa2XB29BUIJQZ1Wg-F5XiDE7XD5y7mjQ__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__Fx0_w1L9q3nwzXnALG7UfjLF34FGYgJTz636-GWbM6k__0jWLTEHP3h5U5RcXuZcFhf0DdvRdzP3_wzCVNT015Ls__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
<link type="text/css" rel="stylesheet" href="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/css__QPp1snPjYt_xYr0c_V0IORcEElkIUBBBrvOB4ZE0Gnw__tsHhQs-0ZQX3RWg3akBhY0psysZPLmDyllt5AIsfUdM__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.css" media="all">
  <script type="text/javascript">
<!--//--><![CDATA[//><!--
var preconnect_support = false; try {if (document.createElement("link").relList.supports("preconnect")) {preconnect_support = true;}} catch (e) {} if (!preconnect_support) { var prefetch = document.createElement("link"); prefetch.href = "https://stats.g.doubleclick.net/robots.txt"; prefetch.rel="prefetch"; document.getElementsByTagName("head")[0].appendChild(prefetch);}
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,r){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date()})(window,document,"script","ga");ga("create", "UA-2360451-1", {"cookieDomain":"auto"});ga("set", "anonymizeIp", true);ga("set", "dimension3", "anonymous user");ga("set", "dimension4", "Documentation page");ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript" async="" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/tagjs"></script><a tabindex="-1" aria-hidden="true" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how?_pxhc=1569230713907" rel="nofollow" target="_blank" style="width: 0px; height: 0px; font-size: 0px; line-height: 0;"></a></head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-2854170 node-type-documentation drupalorg-site-main panels-layout new-style og-context og-context-node og-context-node-2804403 project-issue-focused-input-processed">
  <div id="skip-link">
    <a class="element-invisible element-focusable" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#content">Skip to main content</a>
    <a class="element-invisible element-focusable skip-link-search" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#search-block-form">Skip to search</a>
  </div>
        <div id="nav-header">
    <div class="menu-nav">
      <a class="nav-btn" id="nav-open-btn" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#block-system-main-menu"><img src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/icon-w-menu.svg" alt="Main menu"></a>
    </div>
    <nav id="navigation-inner" class="container-12" role="navigation">
        <div class="region region-navigation">
    <div id="block-system-main-menu" class="block block-system block-menu">
<div class="block-inner">
    
  <div class="content">
    <div class="menu-block"><ul class="menu button"><li class="first leaf"><a href="https://www.drupal.org/home" title="Drupal.org home page">Drupal.org home</a></li>
<li class="expanded"><a href="https://www.drupal.org/about" title="">Why Drupal?</a><div class="menu-block"><ul class="menu button"><li class="first leaf"><a href="https://www.drupal.org/developers" title="">For developers</a></li>
<li class="leaf"><a href="https://www.drupal.org/marketers" title="Why marketers should choose Drupal for their ambitious digital experiences">For marketers</a></li>
<li class="leaf"><a href="https://www.drupal.org/agencies" title="Learn why agencies are betting their future on Drupal">For agencies</a></li>
<li class="leaf"><a href="https://www.drupal.org/case-studies" title="View case studies to see how your peers have built success on Drupal">Case studies</a></li>
<li class="leaf"><a href="https://www.drupal.org/about" title="Learn about Drupal">About Drupal</a></li>
<li class="leaf"><a href="https://www.drupal.org/about/9" title="Prepare for Drupal 9">Drupal 9</a></li>
<li class="last leaf"><a href="https://www.drupal.org/about/in-the-news" title="">In the news</a></li>
</ul></div></li>
<li class="expanded"><a href="https://www.drupal.org/download" title="Build your solution on Drupal">Build</a><div class="menu-block"><ul class="menu button"><li class="first leaf"><a href="https://www.drupal.org/download" title="Download and Extend Drupal">Download &amp; Extend</a></li>
<li class="leaf"><a href="https://git.drupalcode.org/project/drupal" title="">Browse Repository</a></li>
<li class="leaf"><a href="https://www.drupal.org/documentation" title="">Documentation</a></li>
<li class="leaf"><a href="https://www.drupal.org/project/modules" title="Find modules to extend Drupal to meet any need">Modules</a></li>
<li class="leaf"><a href="https://www.drupal.org/project/themes" title="Browse themes as a starting point for making your Drupal site your own">Themes</a></li>
<li class="leaf"><a href="https://www.drupal.org/project/distributions" title="Use a distribution to start with a version of Drupal customized to purpose">Distributions</a></li>
<li class="leaf"><a href="https://www.drupal.org/project/issues" title="Dive into the issues queues and contribute back to Drupal">Issue queues</a></li>
<li class="last leaf"><a href="https://www.drupal.org/about/strategic-initiatives" title="">Strategic Initiatives</a></li>
</ul></div></li>
<li class="expanded"><a href="https://www.drupal.org/industries" title="Examples of solutions built on Drupal">Solutions</a><div class="menu-block"><ul class="menu button"><li class="first leaf"><a href="https://www.drupal.org/industries" title="Learn why Drupal is the best solution for your industry">By industry</a></li>
<li class="leaf"><a href="https://www.drupal.org/case-studies" title="View Drupal success stories">Case studies</a></li>
<li class="last leaf"><a href="https://www.drupal.org/hosting" title="Find a solution for hosting your Drupal application">For hosting</a></li>
</ul></div></li>
<li class="expanded"><a href="https://www.drupal.org/drupal-services" title="Buy Drupal Products and Services">Services</a><div class="menu-block"><ul class="menu button"><li class="first leaf"><a href="https://www.drupal.org/drupal-services" title="View the Drupal service provider marketplace">Marketplace</a></li>
<li class="leaf"><a href="https://www.drupal.org/hosting" title="Find trusted Drupal hosting providers">Hosting</a></li>
<li class="last leaf"><a href="https://www.drupal.org/training" title="Find expert Drupal training">Training</a></li>
</ul></div></li>
<li class="expanded"><a href="https://www.drupal.org/community" title="Drupal Community">Community</a><div class="menu-block"><ul class="menu button"><li class="first leaf"><a href="https://www.drupal.org/community" title="View the community portal and find all the ways you can contribute to Drupal">Portal</a></li>
<li class="leaf"><a href="https://www.drupal.org/getting-involved" title="Read the getting involved guide to learn where you can make the most impact">Getting involved</a></li>
<li class="leaf"><a href="https://www.drupal.org/organizations" title="Learn about the organizations that are part of the Drupal ecosystem">Organizations</a></li>
<li class="leaf"><a href="https://www.drupal.org/forum" title="Find support or chat with the community on the forum">Forum</a></li>
<li class="leaf"><a href="https://www.drupal.org/community/agency-marketing/promotedrupal" title="">Promote Drupal</a></li>
<li class="last leaf"><a href="https://www.drupal.org/case-studies/community" title="">Community Case Studies</a></li>
</ul></div></li>
<li class="expanded"><a href="https://www.drupal.org/documentation" title="Resources to help you on your Drupal journey">Resources</a><div class="menu-block"><ul class="menu button"><li class="first leaf"><a href="https://www.drupal.org/docs/user_guide/en/index.html" title="The Drupal 8 user guide will get you up to speed in no time">User guide</a></li>
<li class="leaf"><a href="https://www.drupal.org/documentation" title="Drupal Documentation">Documentation</a></li>
<li class="leaf"><a href="https://www.drupal.org/support" title="Support for using Drupal">Support</a></li>
<li class="leaf"><a href="https://www.drupal.org/security" title="Find information about security releases for Drupal">Security</a></li>
<li class="leaf"><a href="https://jobs.drupal.org/" title="Drupal Jobs">Jobs</a></li>
<li class="leaf"><a href="https://events.drupal.org/" title="Learn about official Drupal Association events">Events</a></li>
<li class="leaf"><a href="https://www.drupal.org/news" title="News about the Drupal ecosystem">Project News</a></li>
<li class="leaf"><a href="https://www.drupal.org/association/supporters/press" title="News and press releases from Drupal Association supporting partners">Partner Press</a></li>
<li class="last leaf"><a href="https://www.drupal.org/about/9" title="Prepare for Drupal 9">Drupal 9</a></li>
</ul></div></li>
<li class="expanded"><a href="https://www.drupal.org/association" title="About the Drupal Association - the non-profit that supports the Drupal project">Association</a><div class="menu-block"><ul class="menu button"><li class="first leaf"><a href="https://www.drupal.org/association" title="Learn about the Drupal Association - the nonprofit that supports the Drupal project">Drupal Association</a></li>
<li class="leaf"><a href="https://www.drupal.org/association/supporters" title="Learn more about the organizations that support the Drupal Association and our mission">Supporters</a></li>
<li class="leaf"><a href="https://www.drupal.org/promotedrupal" title="">Promote Drupal</a></li>
<li class="leaf"><a href="https://www.drupal.org/association/support" title="We depend on you to move the Drupal project forward">Join us</a></li>
<li class="last leaf"><a href="https://www.drupal.org/drupalorg" title="">About Drupal.org</a></li>
</ul></div></li>
<li class="last expanded"><a href="https://www.drupal.org/try-drupal" title="Try Drupal">Try Drupal</a><div class="menu-block"><ul class="menu button"><li class="first leaf"><a href="https://www.drupal.org/try-drupal" title="Demo Drupal online with a Drupal platform partner">Demo online</a></li>
<li class="last leaf"><a href="https://www.drupal.org/download" title="">Download</a></li>
</ul></div></li>
</ul></div><a class="close-btn" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#top">Return to content</a>  </div>
  </div>
</div>
<div id="block-system-user-menu" class="block block-system block-menu">
<div class="block-inner">
    
  <div class="content">
    <div class="menu-block"><ul class="menu"><li class="button default"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#block-system-user-menu"><img src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/icon-w-user.svg" alt="Log in, view profile, and more"></a><ul><li class="first leaf"><a href="https://www.drupal.org/user/login?destination=node/2854170" title="">Log in</a></li>
<li class="last leaf"><a href="https://www.drupal.org/user/register?destination=node/2854170" title="">Create account</a></li>
</ul></li></ul></div>  </div>
  </div>
</div>
<div id="block-search-form" class="block block-search">
<div class="block-inner">
    
  <div class="content">
    <form action="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how" method="post" id="search-block-form" accept-charset="UTF-8"><div><div class="container-inline">
      <h2 class="element-invisible">Search form</h2>
    <div class="form-item form-type-textfield form-item-search-block-form">
  <label class="element-invisible" for="edit-search-block-form--2">Search </label>
 <input placeholder="Search…" type="text" id="edit-search-block-form--2" name="search_block_form" value="" size="15" maxlength="128" class="form-text">
</div>
<div class="form-actions form-wrapper" id="edit-actions"><input alt="Search" type="image" id="edit-submit" name="submit" value="Search" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/icon-w-search.svg" class="form-submit"></div><input type="hidden" name="form_build_id" value="form-7ozt9eZ8rcei5PTZ4bOYTMETA8lyXN3xyczdzwZF0So">
<input type="hidden" name="form_id" value="search_block_form">
</div>
</div></form>  </div>
  </div>
</div>
  </div>
    </nav>
  </div>

    <div id="header" class="clearfix">
    <div id="header-inner" class="container-12 clearfix">
      <div id="header-left">
        <div id="site-name"><a href="https://www.drupal.org/documentation">Documentation</a></div>
              </div>
      <div id="header-right">
          <div class="region region-header">
    <div id="block-drupalorg-search-documentation" class="block block-drupalorg">
<div class="block-inner">
    
  <div class="content">
    <form class="container-inline" action="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how" method="post" id="drupalorg-documentation-search-form" accept-charset="UTF-8"><div><input type="hidden" name="form_build_id" value="form-UWw7GZnPgQZQxzZx76C7oj6C_h7yEFiWv6ltlpWg_pk">
<input type="hidden" name="form_id" value="drupalorg_documentation_search_form">
<div class="form-item form-type-textfield form-item-drupalorg-documentation-search-form">
  <label class="element-invisible" for="edit-drupalorg-documentation-search-form--2">Search </label>
 <input placeholder="Search documentation…" type="text" id="edit-drupalorg-documentation-search-form--2" name="drupalorg_documentation_search_form" value="" size="15" maxlength="128" class="form-text">
</div>
<div class="form-actions form-wrapper" id="edit-actions--2"><input alt="Search" type="image" id="edit-submit--2" name="submit" value="Search" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/icon-w-search.svg" class="form-submit"></div></div></form>  </div>
  </div>
</div>
  </div>
      </div>
    </div>
  </div>
  
  <div id="page" class="clearfix">
    <div class="breadbox"><nav class="breadcrumb container-12"><span><a href="https://www.drupal.org/docs/7">Drupal 7</a></span><span><a href="https://www.drupal.org/docs/7/creating-custom-modules">Creating custom modules</a></span><span><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos">Module development HowTos</a></span></nav></div>

    
    <div id="main" role="main">
      
      <div id="content" class="clearfix">
                                <div id="content-inner" class="clearfix">

          
            <div class="region region-content">
    <div id="block-system-main" class="block block-system">
<div class="block-inner">
    
  <div class="content">
    
<div class="panelizer-view-mode node node-full node-documentation node-2854170">
        
<div class="panel-display hydra panel-layout clearfix ">

  <div class="container preface clearfix panel-panel">
    <div class="container-inner preface-inner panel-panel-inner">
          </div>
  </div>

  <div class="container content clearfix">
    <div class="container-inner content-inner panel-panel-inner">
      <div class="column-content-region top-right-content column panel-panel">
        <div class="column-content-region-inner top-right-content-inner column-inner panel-panel-inner">
          <div class="panel-pane pane-block pane-table-of-contents-toc-w-3y7froeoqmgrpcmgnphqwt4pi3" id="on-this-page">
  
        <h3 class="pane-title">
      On this page    </h3>
    
  
  <div class="pane-content">
    <div class="item-list"><ul class="anchor-list"><li class="anchor-list__item h2-tag first"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-contents-of-this-page" class="toc-link toc-link-invalid-id active">Contents of this page</a></li>
<li class="anchor-list__item h2-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-concept" class="toc-link toc-link-invalid-id active">Concept</a></li>
<li class="anchor-list__item h2-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-create-a-custom-update-database-module" class="toc-link toc-link-invalid-id active">Create a custom Update Database module&nbsp;</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-updatedbinfo-file" class="toc-link toc-link-invalid-id active">updatedb.info file</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-updatedbmodule-file" class="toc-link toc-link-invalid-id active">updatedb.module file</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-updatedbinstall-file" class="toc-link toc-link-invalid-id active">updatedb.install file</a></li>
<li class="anchor-list__item h2-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-how-to-reverta-custom-modules-update-n-value" class="toc-link toc-link-invalid-id active">How to "revert"&nbsp;a custom module's update 'N value'</a></li>
<li class="anchor-list__item h2-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-how-to-purge-the-install-field-when-it-becomes-too-long" class="toc-link toc-link-invalid-id active">How to purge the .install field when it becomes too long</a></li>
<li class="anchor-list__item h2-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-what-if-you-run-out-of-numbers" class="toc-link toc-link-invalid-id active">What if you run out of numbers?</a></li>
<li class="anchor-list__item h2-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-code-snippets-to-use-in-theupdatedbinstallfile-howto-do-configuration-programmatically" class="toc-link toc-link-invalid-id active">Code snippets to use in the&nbsp;updatedb.install&nbsp;file (how&nbsp;to do configuration programmatically)</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-enable-modules" class="toc-link toc-link-invalid-id active">Enable modules</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-disable-modules" class="toc-link toc-link-invalid-id active">Disable modules</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-enable-a-theme" class="toc-link toc-link-invalid-id active">Enable a theme</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-disable-and-uninstall-modules" class="toc-link toc-link-invalid-id active">Disable and uninstall modules</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-set-a-modules-weight" class="toc-link toc-link-invalid-id active">Set a module's weight</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-revert-a-feature" class="toc-link toc-link-invalid-id active">Revert a Feature</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-alternatively-to-revert-only-for-example-the-field-component-of-that-feature" class="toc-link toc-link-invalid-id active">Alternatively to revert only for example the Field component of that Feature:</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-create-taxonomy-terms-in-a-vocabulary" class="toc-link toc-link-invalid-id active">Create taxonomy terms in a vocabulary</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-delete-field-instance-from-content-types" class="toc-link toc-link-invalid-id active">Delete field instance from content types</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-change-a-field-instance-attribute-for-a-content-type" class="toc-link toc-link-invalid-id active">Change a field instance attribute for a content type</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-modify-a-field-value" class="toc-link toc-link-invalid-id active">Modify a field value</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-add-new-fields" class="toc-link toc-link-invalid-id active">Add new fields</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-delete-a-field" class="toc-link toc-link-invalid-id active">Delete a field</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-delete-nodes-and-content-types" class="toc-link toc-link-invalid-id active">Delete nodes and content types</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-create-or-update-a-view" class="toc-link toc-link-invalid-id active">Create or update a View</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-delete-system-records-for-lost-modules" class="toc-link toc-link-invalid-id active">Delete {system} records for lost modules</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-delete-blocks" class="toc-link toc-link-invalid-id active">Delete blocks</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-hide-or-show-a-block-in-a-theme" class="toc-link toc-link-invalid-id active">Hide or show a block in a theme</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-disable-text-formats" class="toc-link toc-link-invalid-id active">Disable text formats</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-disable-ckeditor-profiles" class="toc-link toc-link-invalid-id active">Disable CKEditor profiles</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-create-a-menu-item" class="toc-link toc-link-invalid-id active">Create a menu item</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-change-existing-language-fields" class="toc-link toc-link-invalid-id active">Change existing language fields</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-drop-a-database-table" class="toc-link toc-link-invalid-id active">Drop a database table</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-change-a-specific-column-value-in-the-database" class="toc-link toc-link-invalid-id active">Change a specific column value in the database</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-remove-duplicate-rows-from-a-database-table-based-on-two-identical-column-values" class="toc-link toc-link-invalid-id active">Remove duplicate rows from a database table based on two identical column values</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-update-urlpatterns-for-node-types-using-pathauto-module" class="toc-link toc-link-invalid-id active">Update url&nbsp;patterns for node types using pathauto module.</a></li>
<li class="anchor-list__item h2-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-from-the-api-documentation-itself" class="toc-link toc-link-invalid-id active">From the API documentation itself</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-add-a-column-to-a-table" class="toc-link toc-link-invalid-id active">Add a column to a table</a></li>
<li class="anchor-list__item h3-tag"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-display-a-message-to-the-user-when-the-update-has-completed" class="toc-link toc-link-invalid-id active">Display a message to the user when the update has completed</a></li>
<li class="anchor-list__item h3-tag last"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-additional-resources" class="toc-link toc-link-invalid-id active">Additional resources</a></li>
</ul></div>  </div>

  
  </div>
<div class="panel-separator"></div><div class="panel-pane pane-block pane-og-menu-og-single-menu-block" id="module-development-howtos">
  
        <h2 class="pane-title">
      <a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos">Module development HowTos</a>    </h2>
    
  
  <div class="pane-content">
    <ul class="menu"><li class="first leaf active-trail"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how" class="active-trail active">Examples for database update scripts using hook_update_N (how&nbsp;to do one time configuration programmatically)</a></li>
<li class="leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/how-to-add-a-column-with-dynamically-generated-action-buttons">How to add a column with dynamically generated action buttons in a View</a></li>
<li class="leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/how-to-change-a-field-value">How to change a field value</a></li>
<li class="leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/how-to-connect-to-multiple-databases-within-drupal">How to connect to multiple databases within Drupal</a></li>
<li class="leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/how-to-integrate-uuid-with-third-party-entities">How to integrate UUID with third party entities</a></li>
<li class="leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/how-to-integrate-with-the-stripe-module">How to integrate with the Stripe module</a></li>
<li class="leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/how-to-make-configuration-objects-exportable-with-ctools">How to make configuration objects exportable with CTools</a></li>
<li class="leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/how-to-rebuild-node_comment_statistics">How to rebuild node_comment_statistics</a></li>
<li class="leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/how-to-update-a-modules-weight">How to update a module's weight</a></li>
<li class="leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/how-to-use-entityfieldquery-for-drupal-7">How to use EntityFieldQuery</a></li>
<li class="leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/paging-non-sql-data">Paging non-SQL data</a></li>
<li class="last leaf"><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/using-template-tplphp-files-in-your-own-module">Using template (.tpl.php) files in your own module</a></li>
</ul>  </div>

  
  </div>
<div class="panel-separator"></div><div class="panel-pane pane-node-links">
  
      
  
  <div class="pane-content">
      </div>

  
  </div>
        </div>
      </div>
      <div class="column-content-region left-content column panel-panel ">
        <div class="column-content-region-inner left-content-inner column-inner panel-panel-inner">
          <div class="panel-pane pane-node-title">
  
      
  
  <div class="pane-content">
    <h1>Examples for database update scripts using hook_update_N (how&nbsp;to do one time configuration programmatically)</h1>
  </div>

  
  </div>
<div class="panel-separator"></div><div class="panel-pane pane-node-updated" id="last-updated-on">
  
        <span class="pane-title">
      Last <a href="https://www.drupal.org/node/2854170/discuss">updated</a> on    </span>
    
  
  <div class="pane-content">
    8 August 2019  </div>

  
  </div>
<div class="panel-separator"></div><div class="panel-pane pane-entity-field pane-node-body">
  
      
  
  <div class="pane-content">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><h2 id="s-contents-of-this-page"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-contents-of-this-page"></a>Contents of this page</h2>
<ul><li><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#concept" rel="nofollow"><strong>Concept</strong></a></li>
<li><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#Create%20a%20custom%20update" rel="nofollow"><strong>Create a custom database update module</strong></a></li>
<li><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#how%20to%20revert" rel="nofollow"><strong>How to "revert" a custom module's update 'N value'</strong></a></li>
<li><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#How%20to%20purge" rel="nofollow"><strong>How to purge the .install field when it becomes too long</strong></a></li>
<li><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#run%20out%20of%20numbers" rel="nofollow"><strong>What if you run out of numbers?</strong></a></li>
<li><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#use%20update.install" rel="nofollow"><strong>Code snippets to use in the updatedb.install file (how to do configuration programmatically)</strong></a></li>
<li><strong><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#additional%20resources" rel="nofollow">Additional resources</a></strong></li>
</ul><h2 id="s-concept"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-concept"></a><a id="concept" name="concept" rel="nofollow">Concept</a></h2>
<p>To deploy settings and configuration on a Drupal 7 live site, the following is most common:</p>
<ol><li>Settings and configuration <strong>not intended to be changed through the UI</strong> on the live site are rolled into code using <a href="https://www.drupal.org/project/features" title="Features | Drupal.org" rel="nofollow">Features</a>&nbsp;together with <a href="https://www.drupal.org/project/strongarm" title="Strongarm | Drupal.org" rel="nofollow">Strongarm</a> and <a href="https://www.drupal.org/node/580026#note" title="Bundling site settings using Features | Drupal.org" rel="nofollow">others</a>. Usually, in a deploy script with <strong><code class=" language-php">drush features<span class="token operator">-</span>revert<span class="token operator">-</span>all</code></strong> (<a href="https://www.drupal.org/docs/7/contrib/features/features-drush" title="Features &amp; Drush | Drupal.org" rel="nofollow">drush fra -y</a>) those are activated on the live site with each deploy, therefore, overwriting any changes made on the live site. A typical use case is the addition of a field to a content type.</li>
<li>Settings and configuration we would like <strong>to be changed and/or controlled on the live site</strong> are rolled into the code and put in an update hook in the <em>.install&nbsp;</em>file of <a href="http://befused.com/drupal/features-settings-alternative" title="Why you should not always use Drupal Features for settings, and what you can use instead | BeFused" rel="nofollow">a custom module</a>. This way they are only executed once (on first deploy using&nbsp;<a href="https://drushcommands.com/drush-7x/core/updatedb/" title="drush updatedb for drush 7.x" rel="nofollow">drush updb -y</a>&nbsp;or&nbsp;running update.php) and will not overwrite site changes on next deploys. Typical use cases are the enabling/disabling/uninstalling of a module or the introduction of a new <a href="https://www.drupal.org/project/views" title="Views | Drupal.org" rel="nofollow">View</a>.</li>
<li>Anything else should be performed <strong>manually</strong> and included in site deploy related Release Notes. Those usually include references to all solved issues (e.g. JIRA stories) and any manual steps that might be involved.</li>
</ol><p><strong>This post focusses on #2</strong>. The "mechanism" behind it is the <a href="https://api.drupal.org/api/drupal/modules%21system%21system.api.php/function/hook_update_N/7.x" title="hook_update_N | system.api.php | Drupal 7.x | Drupal API" rel="nofollow">function hook_update_N</a>. The single update code is wrapped in this sequential numbered function (hence the N) that is tracked in the database to avoid execution if already performed. As said, this is the way to "push" configuration to your production site without overwriting modifications on the live site&nbsp;on a next deploy (as opposed to Features).</p>
<h2 id="s-create-a-custom-update-database-module"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-create-a-custom-update-database-module"></a><a id="Create a custom update" name="Create a custom update" rel="nofollow">Create a custom <em>Update Database</em> module&nbsp;</a></h2>
<p>As an example, we'll create a custom module named&nbsp;<em>Update Database</em> (machine name: <em>updatedb</em>). In reality, you would like to prefix the machine name with your project name to avoid possible future conflicts (e.g. acme_updatedb).</p>
<h3 id="s-updatedbinfo-file"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-updatedbinfo-file"></a><em>updatedb.info</em> file</h3>
<pre class=" language-php"><code class=" language-php">name <span class="token operator">=</span> Update Database
description <span class="token operator">=</span> Purpose is to run the hook_update on every release to implement one<span class="token operator">-</span>time execution of code
core <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">.</span>x
package <span class="token operator">=</span> Custom
</code></pre><h3 id="s-updatedbmodule-file"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-updatedbmodule-file"></a><em>updatedb.module</em> file</h3>
<p>A module file should exist but can be left empty.</p>
<pre class=" language-php"><code class=" language-php"><span class="token delimiter">&lt;?php</span>

<span class="token comment" spellcheck="true">/**
 * @file
 * Update Database module.
 */</span>

<span class="token comment" spellcheck="true">/**
 * A module file must exist, therefore empty.
 */</span></code></pre><h3 id="s-updatedbinstall-file"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-updatedbinstall-file"></a><em>updatedb.install</em> file</h3>
<p>This is the file that actually contains the update hooks we need&nbsp;to be run once for the next deployment. Note that the function comments are actually used and should, therefore, describe what action is executed (e.g. 'Enables&nbsp;module X.').</p>
<pre class=" language-php"><code class=" language-php"><span class="token delimiter">&lt;?php</span>

<span class="token comment" spellcheck="true">/**
 * @file
 * Install file for the Update Database module.
 */</span>
 
<span class="token comment" spellcheck="true">/**
 * Update function for 1st deployment. NOTE: This code comment is used in the list of updates and should be descriptive.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7000</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Some code.</span>
<span class="token punctuation">}</span></code></pre><h2 id="s-how-to-reverta-custom-modules-update-n-value"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-how-to-reverta-custom-modules-update-n-value"></a><a id="how to revert" name="how to revert" rel="nofollow">How to "revert"&nbsp;a custom module's update 'N value'</a></h2>
<p>D7 only: If you need to execute an update hook another time when testing it locally&nbsp;you can&nbsp;"revert" a custom module's update 'N value' with:</p>
<pre class=" language-php"><code class=" language-php"><span class="token constant">UPDATE</span> system <span class="token constant">SET</span> schema_version <span class="token operator">=</span> <span class="token punctuation">[</span>last_successful_update_ID<span class="token punctuation">]</span> <span class="token constant">WHERE</span> name <span class="token operator">=</span> <span class="token string">'[name_of_module]'</span><span class="token punctuation">;</span></code></pre><p>Replace the square brackets plus its content. See <a href="https://drupal.stackexchange.com/a/69841/19480" title="updating - Resetting/reverting a custom module&#39;s update &#39;N value&#39; - Drupal Answers" rel="nofollow">https://drupal.stackexchange.com/a/69841/19480</a>.</p>
<p>Using drush through a Drupal API function, both valid for D7 and D8:</p>
<pre class=" language-php"><code class=" language-php">drush ev <span class="token string">"drupal_set_installed_schema_version('[name_of_module]', [last_successful_update_ID])"</span></code></pre><p>Or you could install the drush&nbsp;<a href="https://github.com/danshumaker/drush-uroll" rel="nofollow">uroll&nbsp;</a>module and do</p>
<pre class=" language-php"><code class=" language-php">drush uroll <span class="token operator">--</span>module<span class="token operator">=</span><span class="token punctuation">[</span>name_of_module<span class="token punctuation">]</span> <span class="token operator">--</span>version<span class="token operator">=</span><span class="token punctuation">[</span>last_successful_udpate_ID<span class="token punctuation">]</span></code></pre><h2 id="s-how-to-purge-the-install-field-when-it-becomes-too-long"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-how-to-purge-the-install-field-when-it-becomes-too-long"></a><a id="How to purge" name="How to purge" rel="nofollow">How to purge the .install field when it becomes too long</a></h2>
<p>As you now push many one-time configuration changes through the updatedb.install file it might get too big for your liking, especially if you use it also for Views changes (consider to use a separate <em>viewsupdatedb</em> module for that).&nbsp;If you remove some update functions from your updatedb.install file, you should notify Drupal of those missing functions. This way, Drupal can ensure that no update is accidentally skipped.</p>
<p>The below example snippet&nbsp;would be inserted before <em>function updatedb_update_7255</em>.&nbsp;</p>
<pre class=" language-php"><code class=" language-php"><span class="token keyword keyword-function">function</span> <span class="token function">hook_update_last_removed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-return">return</span> <span class="token number">7254</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>You can leave one or several of the latest update hooks without problems.&nbsp;Whatever you might expect still&nbsp;needs to run on existing older code bases&nbsp;e.g. on developer machines that did not pull the latest code for a while.</p>
<h2 id="s-what-if-you-run-out-of-numbers"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-what-if-you-run-out-of-numbers"></a><a id="run out of numbers" name="run out of numbers" rel="nofollow">What if you run out of numbers?</a></h2>
<p>The second digit of the N number is officially for the major version of the release&nbsp;of your custom module named&nbsp;<em>Update Database</em> but that leaves you with only 2 digits for sequential counting. Starting with 00 that is good for 100 update hooks. If you don't use the second digit for a major release version (makes sense using it only for deployment) then you have 1000 update hooks available before running out of numbers (until 7999). In case you reached a thousand update hooks you should reset it to be able to continue:</p>
<ul><li>make sure all your environments (including local development installs) have run the update.php with the latest code</li>
<li>remove&nbsp;all functions <em>updatedb_update_N()</em> and <em>updatedb_update_last_removed()</em>&nbsp;(see previous paragraph) from the&nbsp;<em>updatedb.install</em> file</li>
<li>make sure all environments pull the latest again</li>
<li>reset the schema_version to 7000 on all environments as described above.</li>
</ul><p>You should now use <em>function updatedb_update_7001(&amp;$sandbox)</em> as the next update hook.</p>
<h2 id="s-code-snippets-to-use-in-theupdatedbinstallfile-howto-do-configuration-programmatically"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-code-snippets-to-use-in-theupdatedbinstallfile-howto-do-configuration-programmatically"></a><a id="use update.install" name="use update.install" rel="nofollow">Code snippets to use in the&nbsp;<em>updatedb.install&nbsp;</em>file (how&nbsp;to do configuration programmatically)</a></h2>
<p>Below are the code snippets that can be used in the&nbsp;file&nbsp;<em>updatedb.install</em>&nbsp;of a&nbsp;custom deployment module named <em>updatedb&nbsp;</em>to run one-time automatic database updates on the next deploy. When copy-pasting to your own module make sure to change the module machine name and the number to use (sequential following the one of last update hook ).</p>
<p>Some snippets target a contributed&nbsp;module like Features of CKEditor.</p>
<h3 id="s-enable-modules"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-enable-modules"></a>Enable modules</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Enable the modules some_module and some_other_module.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7000</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$module_list</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'some_module'</span><span class="token punctuation">,</span>
    <span class="token string">'some_other_module'</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">module_enable</span><span class="token punctuation">(</span><span class="token variable">$module_list</span><span class="token punctuation">,</span> <span class="token constant">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><p>D8:&nbsp;</p>
<pre class=" language-php"><code class=" language-php">\<span class="token scope">Drupal<span class="token punctuation">::</span></span><span class="token function">service</span><span class="token punctuation">(</span><span class="token string">'module_installer'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">install</span><span class="token punctuation">(</span><span class="token variable">$module_list</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="s-disable-modules"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-disable-modules"></a>Disable modules</h3>
<pre class=" language-php"><code class=" language-php"><span class="token operator">*</span><span class="token operator">*</span>
 <span class="token operator">*</span> Disable the modules some_module <span class="token keyword keyword-and">and</span> some_other_module<span class="token punctuation">.</span>
 <span class="token operator">*</span><span class="token operator">/</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7001</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$module_list</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'some_module'</span><span class="token punctuation">,</span>
    <span class="token string">'some_other_module'</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">module_disable</span><span class="token punctuation">(</span><span class="token variable">$module_list</span><span class="token punctuation">,</span> <span class="token constant">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="s-enable-a-theme"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-enable-a-theme"></a>Enable a theme</h3>
<pre class=" language-php"><code class=" language-php"><span class="token operator">*</span><span class="token operator">*</span>
 <span class="token operator">*</span> Enable some_theme<span class="token punctuation">.</span>
 <span class="token operator">*</span><span class="token operator">/</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7001</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$theme_list</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'some_theme'</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">theme_enable</span><span class="token punctuation">(</span><span class="token variable">$theme_list</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-disable-and-uninstall-modules"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-disable-and-uninstall-modules"></a>Disable and uninstall modules</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Disable and uninstall the modules some_module and some_other_module.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7002</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$module_list</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'some_module'</span><span class="token punctuation">,</span>
    <span class="token string">'some_other_module'</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">module_disable</span><span class="token punctuation">(</span><span class="token variable">$module_list</span><span class="token punctuation">,</span> <span class="token constant">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drupal_uninstall_modules</span><span class="token punctuation">(</span><span class="token variable">$module_list</span><span class="token punctuation">,</span> <span class="token constant">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>For <strong>Drupal 8</strong>&nbsp;&nbsp;the usual workflow is that at you uninstall the module manually locally, using drush or the UI, and then export the config and deploy that. Source: <a href="https://drupal.stackexchange.com/a/214946/19480" rel="nofollow">Drupal 8 - YML For Enabling a Contrib Module - Drupal Answers</a>. It will remove the module from the <em>core.extenions.</em><em>yml</em><em> </em>file.</p>
<p>However, there are some cases where using an update hook would still be needed. For example, a custom module that adds an entity type and has content for those entities. It can't be uninstalled because the content would get in the way of the uninstall safety checks. The update hook can then be used to first delete all the content and then uninstall the module.</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Uninstall MY_MODULE (machine names).
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_8001</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// Delete all nodes of a certain type.</span>
  <span class="token variable">$content_type</span> <span class="token operator">=</span> \<span class="token scope">Drupal<span class="token punctuation">::</span></span><span class="token function">entityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token string">'node_type'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'MACHINE_NAME_OF_TYPE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$content_type</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// Uninstall the module that created that content type.</span>
  \<span class="token scope">Drupal<span class="token punctuation">::</span></span><span class="token function">service</span><span class="token punctuation">(</span><span class="token string">'module_installer'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">uninstall</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'MY_MODULE'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-set-a-modules-weight"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-set-a-modules-weight"></a>Set a module's weight</h3>
<p>Set a low weight (including negative numbers) to get your module to execute before others. Set a high weight to execute after other modules. If no weight is defined modules get a default weight of 0.</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Set weight of the My Funky Module module to 13.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">my_funky_module_update_7100</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">db_update</span><span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'weight'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'my_funky_module'</span><span class="token punctuation">,</span> <span class="token string">'='</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Source:&nbsp;<a href="https://www.drupal.org/node/110238" rel="nofollow">How to update a module's weight</a> | Drupal.org</p>
<h3 id="s-revert-a-feature"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-revert-a-feature"></a>Revert a Feature</h3>
<p>Usually during a deploy <em>update_hooks</em> run before the <em>drush features-revert-all</em>. That means that update hooks that contain code that relies on certain features being present won't work. A typical use case is the creation of a vocabulary through Features where it should exist before creating terms in it.</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Revert feature myfeaturemodule.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7003</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">features_revert_module</span><span class="token punctuation">(</span><span class="token string">'myfeaturemodule'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-alternatively-to-revert-only-for-example-the-field-component-of-that-feature"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-alternatively-to-revert-only-for-example-the-field-component-of-that-feature"></a>Alternatively to revert only for example the Field component of that Feature:</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Revert fields in the feature myfeaturemodule.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7003</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">features_revert</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'myfeaturemodule'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'field'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-create-taxonomy-terms-in-a-vocabulary"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-create-taxonomy-terms-in-a-vocabulary"></a>Create taxonomy terms in a vocabulary</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Create taxonomy terms for myvocabulary.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7004</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token variable">$vocab</span> <span class="token operator">=</span> <span class="token function">taxonomy_vocabulary_machine_name_load</span><span class="token punctuation">(</span><span class="token string">'myvocabulary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$terms</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'myterm1'</span><span class="token punctuation">,</span> <span class="token string">'weight'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'myterm2'</span><span class="token punctuation">,</span> <span class="token string">'weight'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'myterm3'</span><span class="token punctuation">,</span> <span class="token string">'weight'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$terms</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$term</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$term</span> <span class="token operator">=</span> <span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
          <span class="token string">'vid'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$vocab</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">vid</span><span class="token punctuation">,</span>
          <span class="token string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$term</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string">'weight'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$term</span><span class="token punctuation">[</span><span class="token string">'weight'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">taxonomy_term_save</span><span class="token punctuation">(</span><span class="token variable">$term</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre><h3 id="s-delete-field-instance-from-content-types"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-delete-field-instance-from-content-types"></a>Delete field instance from content types</h3>
<pre class=" language-php"><code class=" language-php"><span class="token operator">*</span><span class="token operator">*</span>
 <span class="token operator">*</span> Delete field field_mycustomfield field from content types<span class="token punctuation">.</span>
 <span class="token operator">*</span><span class="token operator">/</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7005</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$types</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'content_type1'</span><span class="token punctuation">,</span>
    <span class="token string">'content_type2'</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$types</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$instance</span> <span class="token operator">=</span> <span class="token function">field_info_instance</span><span class="token punctuation">(</span><span class="token string">'node'</span><span class="token punctuation">,</span> <span class="token string">'field_mycustomfield'</span><span class="token punctuation">,</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">field_delete_instance</span><span class="token punctuation">(</span><span class="token variable">$instance</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="s-change-a-field-instance-attribute-for-a-content-type"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-change-a-field-instance-attribute-for-a-content-type"></a>Change a field instance attribute for a content type</h3>
<pre class=" language-php"><code class=" language-php"><span class="token operator">*</span><span class="token operator">*</span>
 <span class="token operator">*</span> Change the body field submission guideline <span class="token keyword keyword-for">for</span> some_content_type<span class="token punctuation">.</span>
 <span class="token operator">*</span><span class="token operator">/</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7005</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$instance</span> <span class="token operator">=</span> <span class="token function">field_read_instance</span><span class="token punctuation">(</span><span class="token string">'node'</span><span class="token punctuation">,</span> <span class="token string">'body'</span><span class="token punctuation">,</span> <span class="token string">'some_content_type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$instance</span><span class="token punctuation">[</span><span class="token string">'description'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'Some submission guideline.'</span><span class="token punctuation">;</span>
  <span class="token function">field_update_instance</span><span class="token punctuation">(</span><span class="token variable">$instance</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="s-modify-a-field-value"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-modify-a-field-value"></a>Modify a field value</h3>
<p>As an example, we show a common use case of replacing certain absolute URLs in the body field with a relative one.</p>
<pre class=" language-php"><code class=" language-php"><span class="token operator">*</span><span class="token operator">*</span>
 <span class="token operator">*</span> Replace absolute URLs to root with a relative one<span class="token punctuation">.</span>
 <span class="token operator">*</span><span class="token operator">/</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7005</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">db_update</span><span class="token punctuation">(</span><span class="token string">'field_data_body'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'body_value'</span><span class="token punctuation">,</span> <span class="token string">'%href="http://www.mywebsite.com/%'</span><span class="token punctuation">,</span> <span class="token string">'LIKE'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expression</span><span class="token punctuation">(</span><span class="token string">'body_value'</span><span class="token punctuation">,</span> <span class="token string">'REPLACE(body_value, :oldtext, :newtext)'</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
        <span class="token string">':oldtext'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'href="http://www.mywebsite.com/'</span><span class="token punctuation">,</span>
        <span class="token string">':newtext'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'href="/'</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="s-add-new-fields"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-add-new-fields"></a>Add new fields</h3>
<p>See&nbsp;<a href="https://www.drupal.org/node/150215" title=" hook_update_N() functions | Drupal.org" rel="nofollow">https://www.drupal.org/node/150215</a>.</p>
<h3 id="s-delete-a-field"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-delete-a-field"></a>Delete a field</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Delete field field_myfield.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7006</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">field_delete_field</span><span class="token punctuation">(</span><span class="token string">'myfield'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// Note: only run field_purge_batch if you want to remove immediately. </span>
  <span class="token comment" spellcheck="true">// Otherwise it will be removed from next cron run.</span>
  <span class="token function">field_purge_batch</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-delete-nodes-and-content-types"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-delete-nodes-and-content-types"></a>Delete nodes and content types</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Delete nodes and content types mycontenttype1, mycontenttype2.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7007</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$types</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'mycontenttype1'</span><span class="token punctuation">,</span>
    <span class="token string">'mycontenttype2'</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$types</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// First, delete nodes</span>
    <span class="token variable">$results</span> <span class="token operator">=</span> <span class="token function">db_select</span><span class="token punctuation">(</span><span class="token string">'node'</span><span class="token punctuation">,</span> <span class="token string">'n'</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'nid'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token variable">$type</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$nids</span> <span class="token operator">=</span> <span class="token variable">$results</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fetchCol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$nids</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">node_delete_multiple</span><span class="token punctuation">(</span><span class="token variable">$nids</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">drupal_set_message</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'%count nodes have been deleted.'</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'%count'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$nids</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment" spellcheck="true">// Then, delete content type</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">node_type_load</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">node_type_delete</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">variable_del</span><span class="token punctuation">(</span><span class="token string">'field_bundle_settings_node__'</span> <span class="token punctuation">.</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">variable_del</span><span class="token punctuation">(</span><span class="token string">'language_content_type_'</span> <span class="token punctuation">.</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">variable_del</span><span class="token punctuation">(</span><span class="token string">'menu_options_'</span> <span class="token punctuation">.</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">variable_del</span><span class="token punctuation">(</span><span class="token string">'menu_parent_'</span> <span class="token punctuation">.</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">variable_del</span><span class="token punctuation">(</span><span class="token string">'node_options_'</span> <span class="token punctuation">.</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">variable_del</span><span class="token punctuation">(</span><span class="token string">'node_preview_'</span> <span class="token punctuation">.</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">variable_del</span><span class="token punctuation">(</span><span class="token string">'node_submitted_'</span> <span class="token punctuation">.</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">drupal_set_message</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'%type content type has been deleted.'</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'%type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">node_types_rebuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">menu_rebuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Source: <a href="https://api.drupal.org/comment/61128#comment-61128" rel="nofollow">https://api.drupal.org/comment/61128#comment-61128</a></p>
<p>The menu item at&nbsp;<em>node/add/[content-type]</em>&nbsp;probably still needs to be&nbsp;'Reset' at&nbsp;<em>admin/structure/menu/manage/navigation</em>.<br>
@TODO: See how to do that programmatically (<em>function menu_reset_item($link)&nbsp;</em>in&nbsp;<em>modules/menu/menu.module</em>?).</p>
<p>Note that if the content type is included in a Feature you have to remove it there first, recreate the Feature and include in the code below as the first line:</p>
<pre class=" language-php"><code class=" language-php"><span class="token function">features_revert_module</span><span class="token punctuation">(</span><span class="token string">'myfeaturemodule'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Not doing that results in only the nodes being deleted but not the content type.</p>
<h3 id="s-create-or-update-a-view"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-create-or-update-a-view"></a>Create or update a View</h3>
<p>You can export any View from <em>admin/structure/views/view/[view_machine_name]/export</em>. Just copy-paste the code into an update hook and end with <strong><code class=" language-php"><span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></strong> (not included in the export). If the View doesn't exist it will create it. It overwrites an existing one with the same name.</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Create or update the existing view.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7008</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$view</span> <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">name</span> <span class="token operator">=</span> <span class="token string">'my_simple_view_of_articles'</span><span class="token punctuation">;</span>
  <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">description</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">tag</span> <span class="token operator">=</span> <span class="token string">'default'</span><span class="token punctuation">;</span>
  <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">base_table</span> <span class="token operator">=</span> <span class="token string">'node'</span><span class="token punctuation">;</span>
  <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">human_name</span> <span class="token operator">=</span> <span class="token string">'My Simple View of Articles'</span><span class="token punctuation">;</span>
  <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">core</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
  <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">api_version</span> <span class="token operator">=</span> <span class="token string">'3.0'</span><span class="token punctuation">;</span>
  <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">disabled</span> <span class="token operator">=</span> <span class="token constant">FALSE</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* Edit this to true to make a default view disabled initially */</span>

  <span class="token comment" spellcheck="true">/* Display: Master */</span>
  <span class="token variable">$handler</span> <span class="token operator">=</span> <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">new_display</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token string">'Master'</span><span class="token punctuation">,</span> <span class="token string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'My Simple View of Articles'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'use_more_always'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">FALSE</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'access'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'perm'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'cache'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'none'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'views_query'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'exposed_form'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'basic'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'pager'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'full'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'pager'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'options'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'items_per_page'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'10'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'style_plugin'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'default'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'row_plugin'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'node'</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">/* Field: Content: Title */</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'fields'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'title'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'fields'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'table'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'node'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'fields'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'title'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'fields'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'fields'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'alter'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'word_boundary'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">FALSE</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'fields'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'alter'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'ellipsis'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">FALSE</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">/* Sort criterion: Content: Post date */</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'sorts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'created'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'created'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'sorts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'created'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'table'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'node'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'sorts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'created'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'created'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'sorts'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'created'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'order'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'DESC'</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">/* Filter criterion: Content: Published */</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'filters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'status'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'filters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'table'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'node'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'filters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'status'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'filters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'filters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'group'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'filters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'expose'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'operator'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">FALSE</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">/* Filter criterion: Content: Type */</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'filters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'type'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'filters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'table'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'node'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'filters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'field'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'type'</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'filters'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'article'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'article'</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment" spellcheck="true">/* Display: Page */</span>
  <span class="token variable">$handler</span> <span class="token operator">=</span> <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">new_display</span><span class="token punctuation">(</span><span class="token string">'page'</span><span class="token punctuation">,</span> <span class="token string">'Page'</span><span class="token punctuation">,</span> <span class="token string">'page'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$handler</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">display_options</span><span class="token punctuation">[</span><span class="token string">'path'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'my-simple-view-of-articles'</span><span class="token punctuation">;</span>
  <span class="token variable">$translatables</span><span class="token punctuation">[</span><span class="token string">'my_simple_view_of_articles'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Master'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'My Simple View of Articles'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'more'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Apply'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Reset'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Sort by'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Asc'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Desc'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Items per page'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'- All -'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Offset'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'« first'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'‹ previous'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'next ›'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'last »'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Page'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment" spellcheck="true">// Save the view.</span>
  <span class="token comment" spellcheck="true">// Note: This is not present in the exported view code.</span>
  <span class="token variable">$view</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-delete-system-records-for-lost-modules"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-delete-system-records-for-lost-modules"></a>Delete {system} records for lost modules</h3>
<p>Fix for the warning message "<em>The following module is missing from the file system...</em>". See&nbsp;<a href="https://www.drupal.org/node/2487215" rel="nofollow">https://www.drupal.org/node/2487215</a>.</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Delete {system} records for lost modules.
 * Refer: https://www.drupal.org/node/2487215
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7009</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$modules</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'mylostmodule'</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">db_delete</span><span class="token punctuation">(</span><span class="token string">'system'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token variable">$modules</span><span class="token punctuation">,</span> <span class="token string">'IN'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'module'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-delete-blocks"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-delete-blocks"></a>Delete blocks</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Remove unused blocks.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7010</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$blocks_array</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'module'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'block'</span><span class="token punctuation">,</span> <span class="token string">'delta'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'45'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'module'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'block'</span><span class="token punctuation">,</span> <span class="token string">'delta'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'66'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'module'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'block'</span><span class="token punctuation">,</span> <span class="token string">'delta'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'30'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token variable">$log_data</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blocks_array</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$block_arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$block</span> <span class="token operator">=</span> <span class="token function">block_load</span><span class="token punctuation">(</span><span class="token variable">$block_arr</span><span class="token punctuation">[</span><span class="token string">'module'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$block_arr</span><span class="token punctuation">[</span><span class="token string">'delta'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">is_object</span><span class="token punctuation">(</span><span class="token variable">$block</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$block</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">bid</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">db_delete</span><span class="token punctuation">(</span><span class="token string">'block_custom'</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'bid'</span><span class="token punctuation">,</span> <span class="token variable">$block</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">delta</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">db_delete</span><span class="token punctuation">(</span><span class="token string">'block'</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'block'</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'delta'</span><span class="token punctuation">,</span> <span class="token variable">$block</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">delta</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">db_delete</span><span class="token punctuation">(</span><span class="token string">'block_role'</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'block'</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'delta'</span><span class="token punctuation">,</span> <span class="token variable">$block</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">delta</span><span class="token punctuation">)</span>
          <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token variable">$log_data</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$block_arr</span><span class="token punctuation">[</span><span class="token string">'delta'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token constant">PHP_EOL</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
      <span class="token variable">$log_data</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token variable">$block_arr</span><span class="token punctuation">[</span><span class="token string">'delta'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">" not loaded and not deleted from DB | "</span> <span class="token punctuation">.</span> <span class="token constant">PHP_EOL</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">cache_clear_all</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">'cache_block'</span><span class="token punctuation">,</span> <span class="token constant">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">watchdog</span><span class="token punctuation">(</span><span class="token string">"Deleted Blocks: "</span><span class="token punctuation">,</span> <span class="token variable">$log_data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-hide-or-show-a-block-in-a-theme"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-hide-or-show-a-block-in-a-theme"></a>Hide or show a block in a theme</h3>
<p>As an example, we disable and move to the 'Disabled' section the user login block.</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Hide login block.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7011</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">db_update</span><span class="token punctuation">(</span><span class="token string">'block'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
        <span class="token string">'region'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// Change to e.g. 'sidebar_first' to place the block in this region.</span>
        <span class="token string">'status'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// Change to 1 to enable the block instead.</span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'delta'</span><span class="token punctuation">,</span> <span class="token string">'login'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'theme'</span><span class="token punctuation">,</span> <span class="token string">'bartik'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-disable-text-formats"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-disable-text-formats"></a>Disable text formats</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Disable text format.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7011</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$formats</span> <span class="token operator">=</span> <span class="token function">filter_formats</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">filter_format_disable</span><span class="token punctuation">(</span><span class="token variable">$formats</span><span class="token punctuation">[</span><span class="token string">'some_text_format'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-disable-ckeditor-profiles"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-disable-ckeditor-profiles"></a>Disable CKEditor profiles</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Disable CKEditor profiles.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7012</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">module_load_include</span><span class="token punctuation">(</span><span class="token string">'inc'</span><span class="token punctuation">,</span> <span class="token string">'ckeditor'</span><span class="token punctuation">,</span> <span class="token string">'includes/ckeditor.admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">ckeditor_profile_delete</span><span class="token punctuation">(</span><span class="token string">'some_profile'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-create-a-menu-item"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-create-a-menu-item"></a>Create a menu item</h3>
<p>As an example, we add a common use case of adding the link to a View to the Content admin menu to show certain content separately. <em>plid</em> = parent link id (<em>mlid</em> of the parent)</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Create a menu item.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7013</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$item</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'link_title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"Some View title"</span><span class="token punctuation">,</span>
    <span class="token string">'link_path'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'admin/content/some_view'</span><span class="token punctuation">,</span>
    <span class="token string">'menu_name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'management'</span><span class="token punctuation">,</span>
    <span class="token string">'weight'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token string">'plid'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">9</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">menu_link_save</span><span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-change-existing-language-fields"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-change-existing-language-fields"></a>Change existing language fields</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Perform the queries to switch DB all language fields from NL to UND.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7001</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$table_list</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'node'</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$table_list</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">db_update</span><span class="token punctuation">(</span><span class="token variable">$table</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
        <span class="token string">'language'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'und'</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'language'</span><span class="token punctuation">,</span> <span class="token string">'nl'</span><span class="token punctuation">,</span> <span class="token string">'='</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-drop-a-database-table"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-drop-a-database-table"></a>Drop a database table</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Drop {some_table} from the database.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7013</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">db_table_exists</span><span class="token punctuation">(</span><span class="token string">'some_table'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">db_drop_table</span><span class="token punctuation">(</span><span class="token string">'some table'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-change-a-specific-column-value-in-the-database"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-change-a-specific-column-value-in-the-database"></a>Change a specific column value in the database</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Switch in some_column from old_value to new_value in some_table and some_other_table.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7001</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$table_list</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'some_table'</span><span class="token punctuation">,</span>
    <span class="token string">'some_other_table'</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$table_list</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$table</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">db_update</span><span class="token punctuation">(</span><span class="token variable">$table</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
        <span class="token string">'some_column'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'new_value'</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'some_column'</span><span class="token punctuation">,</span> <span class="token string">'old_value'</span><span class="token punctuation">,</span> <span class="token string">'='</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="s-remove-duplicate-rows-from-a-database-table-based-on-two-identical-column-values"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-remove-duplicate-rows-from-a-database-table-based-on-two-identical-column-values"></a>Remove duplicate rows from a database table based on two identical column values</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Remove duplicate rows where column3 = 'some_value' comparing two columns with identical value.
 *
 * Example column1: entity_id, column2: revision_id, column3: language (taken for metatag table).
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7001</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token function">db_query</span><span class="token punctuation">(</span>"
    <span class="token constant">SELECT</span> entity_id
    <span class="token constant">FROM</span> metatag
       <span class="token constant">INNER</span> <span class="token constant">JOIN</span> <span class="token punctuation">(</span><span class="token constant">SELECT</span> revision_id
                   <span class="token constant">FROM</span>   metatag
                   <span class="token constant">GROUP</span>  <span class="token constant">BY</span> revision_id
                   <span class="token constant">HAVING</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>revision_id<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> dup
               <span class="token constant">ON</span> metatag<span class="token punctuation">.</span>revision_id <span class="token operator">=</span> dup<span class="token punctuation">.</span>revision_id
    <span class="token constant">WHERE</span> language <span class="token operator">=</span> <span class="token string">'nl'</span>
  "<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$results</span> <span class="token operator">=</span> <span class="token variable">$query</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fetchAllAssoc</span><span class="token punctuation">(</span><span class="token string">'entity_id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$results</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$num_deleted</span> <span class="token operator">=</span> <span class="token function">db_delete</span><span class="token punctuation">(</span><span class="token string">'metatag'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'entity_id'</span><span class="token punctuation">,</span> <span class="token variable">$key</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'language'</span><span class="token punctuation">,</span> <span class="token string">'nl'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-update-urlpatterns-for-node-types-using-pathauto-module"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-update-urlpatterns-for-node-types-using-pathauto-module"></a>Update url&nbsp;patterns for node types using pathauto module.</h3>
<pre class=" language-php"><code class=" language-php"><span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7001</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">variable_set</span><span class="token punctuation">(</span><span class="token string">'pathauto_node_mynodetype1_pattern'</span><span class="token punctuation">,</span> <span class="token string">'[node:menu-link:menu:name]/[node:title]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">variable_set</span><span class="token punctuation">(</span><span class="token string">'pathauto_node_mynodetype2_pattern'</span><span class="token punctuation">,</span> <span class="token string">'[node:menu-link:menu:name]/[node:menu-link:parent:root]/[node:title]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Feel free to add other snippets</p>
<h2 id="s-from-the-api-documentation-itself"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-from-the-api-documentation-itself"></a>From the API documentation itself</h2>
<h3 id="s-add-a-column-to-a-table"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-add-a-column-to-a-table"></a>Add a column to a table</h3>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Add a column the database table {some_table}.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7014</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">db_add_field</span><span class="token punctuation">(</span><span class="token string">'some_table'</span><span class="token punctuation">,</span> <span class="token string">'newcol'</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token string">'not null'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">TRUE</span><span class="token punctuation">,</span> <span class="token string">'description'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'My new integer column.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Alternatively:</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Add newcol field to {mytable1} table.
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7014</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$spec</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'varchar'</span><span class="token punctuation">,</span>
    <span class="token string">'description'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">"New Col"</span><span class="token punctuation">,</span>
    <span class="token string">'length'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">,</span>
    <span class="token string">'not null'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">FALSE</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token function">db_add_field</span><span class="token punctuation">(</span><span class="token string">'mytable1'</span><span class="token punctuation">,</span> <span class="token string">'newcol'</span><span class="token punctuation">,</span> <span class="token variable">$spec</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>For operations that may take a long time&nbsp;hook into the Batch API</p>
<pre class=" language-php"><code class=" language-php"><span class="token comment" spellcheck="true">/**
 * Update 3 users at a time to have an exclamation point after their names..
 */</span>
<span class="token keyword keyword-function">function</span> <span class="token function">updatedb_update_7015</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'progress'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'progress'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'current_uid'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment" spellcheck="true">// We'll -1 to disregard the uid 0...</span>
    <span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'max'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">db_query</span><span class="token punctuation">(</span><span class="token string">'SELECT COUNT(DISTINCT uid) FROM {users}'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fetchField</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token variable">$users</span> <span class="token operator">=</span> <span class="token function">db_select</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">,</span> <span class="token string">'u'</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token string">'u'</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">,</span> <span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'current_uid'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'&gt;'</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">orderBy</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">,</span> <span class="token string">'ASC'</span><span class="token punctuation">)</span>
    <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$users</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">name</span> <span class="token punctuation">.</span><span class="token operator">=</span> <span class="token string">'!'</span><span class="token punctuation">;</span>
    <span class="token function">db_update</span><span class="token punctuation">(</span><span class="token string">'users'</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">fields</span><span class="token punctuation">(</span><span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">condition</span><span class="token punctuation">(</span><span class="token string">'uid'</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">uid</span><span class="token punctuation">)</span>
      <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'progress'</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'current_uid'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">uid</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'#finished'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'max'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'progress'</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token variable">$sandbox</span><span class="token punctuation">[</span><span class="token string">'max'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="s-display-a-message-to-the-user-when-the-update-has-completed"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-display-a-message-to-the-user-when-the-update-has-completed"></a>Display a message to the user when the update has completed</h3>
<p>Just add inside at the end of the update hook:</p>
<pre class=" language-php"><code class=" language-php">  <span class="token keyword keyword-return">return</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'The update did what it was supposed to do.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>In case of an error, simply throw an exception with an error message</p>
<p>Just add inside at the end of the update hook:</p>
<pre class=" language-php"><code class=" language-php">  <span class="token keyword keyword-throw">throw</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">DrupalUpdateException</span><span class="token punctuation">(</span><span class="token string">'Something went wrong; here is what you should do.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="s-additional-resources"><a class="toc-anchor" title="Permalink to this headline" href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/examples-for-database-update-scripts-using-hook_update_n-how#s-additional-resources"></a><a id="additional resources" name="additional resources" rel="nofollow">Additional resources</a></h3>
<ul><li>
<p><a href="https://www.drupal.org/docs/7/api/schema-api/updating-tables-hook_update_n-functions" rel="nofollow">https://www.drupal.org/docs/7/api/schema-api/updating-tables-hook_update...</a></p>
</li>
<li>
<p><a href="http://befused.com/drupal/site-deployment-module" rel="nofollow">http://befused.com/drupal/site-deployment-module</a></p>
</li>
<li>
<p><a href="https://www.metaltoad.com/blog/how-write-drupal-update-scripts" rel="nofollow">https://www.metaltoad.com/blog/how-write-drupal-update-scripts</a></p>
</li>
<li>
<p><a href="http://blog.dcycle.com/blog/44/what-site-deployment-module" rel="nofollow">http://blog.dcycle.com/blog/44/what-site-deployment-module</a></p>
</li>
</ul></div></div></div>  </div>

  
  </div>
<div class="panel-separator"></div><div class="panel-pane pane-views-panes pane-documentation-related-content-related-content-pane" id="related-content">
  
        <h2 class="pane-title">
      Related Content    </h2>
    
  
  <div class="pane-content">
    <div class="view view-documentation-related-content view-id-documentation_related_content view-display-id-related_content_pane view-dom-id-a2a2c0af50a3458a61d1de2999b766a6">
        
  
  
      <div class="view-content">
        <div>
    <div id="node-150215" class="node node-documentation node-content-150215 clearfix">

  
        <h2><a href="https://www.drupal.org/docs/7/api/schema-api/updating-tables-hook_update_n-functions">Updating tables: hook_update_N() functions</a></h2>
    
  
  <div class="content">
    <div class="field field-name-field-summary field-type-text field-label-hidden"><div class="field-items"><div class="field-item even">As in previous versions of Drupal, you can update database tables for new versions using a hook_update_N() function. Note that when you</div></div></div>  </div>

  

</div>

  </div>
  <div>
    <div id="node-110238" class="node node-documentation node-content-110238 clearfix">

  
        <h2><a href="https://www.drupal.org/docs/7/creating-custom-modules/howtos/how-to-update-a-modules-weight">How to update a module's weight</a></h2>
    
  
  <div class="content">
    <div class="field field-name-field-summary field-type-text field-label-hidden"><div class="field-items"><div class="field-item even">In Drupal, the order in which a module's hooks get called is dependent on the weight of your module in the system table.  </div></div></div>  </div>

  

</div>

  </div>
    </div>
  
  
  
  
  
  
</div>  </div>

  
  </div>
        </div>
      </div>
      <div class="column-content-region bottom-right-content column panel-panel">
        <div class="column-content-region-inner bottom-right-content-inner column-inner panel-panel-inner">
                  </div>
      </div>
    </div>
  </div>

  <div class="container footer clearfix panel-panel">
    <div class="container-inner footer-inner panel-panel-inner">
          </div>
  </div>

</div><!-- /.sutro -->
</div>
  </div>
  </div>
</div>
  </div>
        </div>
              </div> <!-- /#content -->

    </div> <!-- /#column-left -->

      </div> <!-- /#page -->

  <div id="footer" role="contentinfo">
            <div class="region region-footer">
    <div id="block-drupalorg-documentation-license" class="block block-drupalorg">
<div class="block-inner">
    
  <div class="content">
    Drupal’s online documentation is © 2000-2019 by the individual contributors and can be used in accordance with the <a href="https://www.drupal.org/terms">Creative Commons License, Attribution-ShareAlike 2.0</a>. PHP code is distributed under the <a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html">GNU General Public License</a>.  </div>
  </div>
</div>
<div id="block-drupalorg-crosssite-drupalorg-footer" class="block block-drupalorg-crosssite">
<div class="block-inner">
    
  <div class="content">
    <h4 class="element-invisible">News items</h4><ul class="drupal-news"><li class="0 first"><a href="https://www.drupal.org/news">News</a></li>
<li class="1"><a href="https://www.drupal.org/planet" title="News from Drupal community members">Planet Drupal</a></li>
<li class="2"><a href="https://www.drupal.org/social-media" title="Drupal on social media">Social media directory</a></li>
<li class="3"><a href="https://www.drupal.org/security" title="Advisories from the security team">Security announcements</a></li>
<li class="4 last"><a href="https://jobs.drupal.org/" title="Drupal Jobs">Jobs</a></li>
</ul><h4 class="element-invisible">Our community</h4><ul class="community"><li class="0 first"><a href="https://drupal.org/community">Community</a></li>
<li class="1"><a href="https://drupal.org/getting-involved" title="Learn how to contribute to the Drupal project">Getting involved</a></li>
<li class="2"><span><a href="https://drupal.org/drupal-services" title="People and organizations offering Drupal services">Services</a>, <a href="https://drupal.org/training" title="People and organizations offering Drupal training">Training</a> &amp; <a href="https://drupal.org/hosting" title="Organizations offering Drupal hosting">Hosting</a></span></li>
<li class="3"><a href="https://groups.drupal.org/groups" title="groups.drupal.org">Groups &amp; Meetups</a></li>
<li class="4"><a href="https://events.drupal.org/" title="Upcoming and past DrupalCons">DrupalCon</a></li>
<li class="5 last"><a href="https://drupal.org/dcoc" title="Drupal code of conduct">Code of conduct</a></li>
</ul><h4 class="element-invisible">Documentation</h4><ul class="get-started"><li class="0 first"><a href="https://drupal.org/documentation" title="Documentation for working with Drupal">Documentation</a></li>
<li class="1"><a href="https://www.drupal.org/docs/8">Drupal 8 docs</a></li>
<li class="2"><a href="https://www.drupal.org/docs/7">Drupal 7 docs</a></li>
<li class="3"><a href="https://www.drupal.org/documentation/develop">Developer docs</a></li>
<li class="4 last"><a href="https://api.drupal.org/" title="Drupal API reference">api.drupal.org</a></li>
</ul><h4 class="element-invisible">Drupal code base</h4><ul class="download-extend"><li class="0 first"><a href="https://drupal.org/download">Download &amp; Extend</a></li>
<li class="1"><a href="https://drupal.org/project/drupal" title="Download the latest version of the Drupal software">Drupal core</a></li>
<li class="2"><a href="https://drupal.org/project/project_module" title="Download add-on features and functionality">Modules</a></li>
<li class="3"><a href="https://drupal.org/project/project_theme" title="Download pre-designed styles for Drupal">Themes</a></li>
<li class="4 last"><a href="https://drupal.org/project/project_distribution" title="Download a pre-packaged Drupal site">Distributions</a></li>
</ul><h4 class="element-invisible">Governance of community</h4><ul class="about"><li class="0 first"><a href="https://drupal.org/about">About</a></li>
<li class="1"><a href="https://drupal.org/about/accessibility" title="Our committment to accessibility">Web accessibility</a></li>
<li class="2"><a href="https://drupal.org/association" title="About the Drupal Association">Drupal Association</a></li>
<li class="3"><a href="https://drupal.org/drupalorg" title="About Drupal.org">About Drupal.org</a></li>
<li class="4"><a href="https://drupal.org/terms" title="Drupal.org terms of service">Terms of service</a></li>
<li class="5 last"><a href="https://drupal.org/privacy" title="Drupal.org privacy policy">Privacy policy</a></li>
</ul>  </div>
  </div>
</div>
<div id="block-block-77" class="block block-block">
<div class="block-inner">
    
  <div class="content">
    <p>Drupal is a <a href="http://drupal.com/trademark">registered trademark</a> of <a href="https://dri.es/">Dries Buytaert</a>.</p>
  </div>
  </div>
</div>
  </div>
      </div>
    <div class="region region-page-bottom">
    <script type="text/javascript">
      (function(){
          window._pxAppId = 'PXVnPBBfwe';
          window._pxParam2 = '';
          window._pxParam3 = '0';
          var p = document.getElementsByTagName('script')[0],
              s = document.createElement('script');
          s.async = 1;
          s.src = '/VnPBBfwe/init.js';
          p.parentNode.insertBefore(s,p);
      }());
  </script>
  <noscript>
      &lt;div style="position:fixed; top:0; left:0; display:none" width="1" height="1"&gt;
          &lt;img src="/VnPBBfwe/xhr/api/v1/collector/noScript.gif?appId=PXVnPBBfwe"&gt;
      &lt;/div&gt;
  </noscript>  </div>

<!--[if lte IE 9]>
<script type="text/javascript" src="/files/advagg_js/js__79M6UrZjAw3oNGnUjsWip12JsvnUZmJGA3h9LI0kuzE__LqE6uSZqCOZhJYW910TDw_HTQzBKUPTZxunfaWkalq8__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js#ie9-" onload="if(jQuery.isFunction(jQuery.holdReady)){jQuery.holdReady(true);}"></script>
<![endif]-->

<!--[if gt IE 9]>
<script type="text/javascript" src="/files/advagg_js/js__79M6UrZjAw3oNGnUjsWip12JsvnUZmJGA3h9LI0kuzE__LqE6uSZqCOZhJYW910TDw_HTQzBKUPTZxunfaWkalq8__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js#ie10+" defer="defer" onload="if(jQuery.isFunction(jQuery.holdReady)){jQuery.holdReady(true);}"></script>
<![endif]-->

<!--[if !IE]><!-->
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/js__79M6UrZjAw3oNGnUjsWip12JsvnUZmJGA3h9LI0kuzE__LqE6uSZqCOZhJYW910TDw_HTQzBKUPTZxunfaWkalq8__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js" defer="defer" onload="if(jQuery.isFunction(jQuery.holdReady)){jQuery.holdReady(true);}"></script>
<!--<![endif]-->
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/js__qvxhs9hiTVr_USTpngJWnfdQEU8sbxmerZ1FBORD7ks__c_vdLVdm2dhTjV0-cjXbrVvnpDDp5m6xnNff8tSZ1fg__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js" defer="defer"></script>
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/js__H5AFmq1RrXKsrazzPq_xPQPy4K0wUKqecPjczzRiTgQ__JIy-3lUpq3qC8JjvfOMkqOB8loYzuE93VQgLvC7HpVM__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js" defer="defer" onload="
function advagg_mod_1() {
  // Count how many times this function is called.
  advagg_mod_1.count = ++advagg_mod_1.count || 1;
  try {
    if (advagg_mod_1.count &lt;= 40) {
      init_drupal_core_settings();

      // Set this to 100 so that this function only runs once.
      advagg_mod_1.count = 100;
    }
  }
  catch(e) {
    if (advagg_mod_1.count &gt;= 40) {
      // Throw the exception if this still fails after running 40 times.
      throw e;
    }
    else {
      // Try again in 1 ms.
      window.setTimeout(advagg_mod_1, 1);
    }
  }
}
function advagg_mod_1_check() {
  if (window.init_drupal_core_settings &amp;&amp; window.jQuery &amp;&amp; window.Drupal) {
    advagg_mod_1();
  }
  else {
    window.setTimeout(advagg_mod_1_check, 1);
  }
}
advagg_mod_1_check();"></script>
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/js__W3HVetagCYpKE0fh-1m9ldkYrnM7EKUfayUOkYfG5ns__WuK1hQPJATa9bKz9C-kkuJb4wU7eT0t_GOkJsnF_TuM__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js" defer="defer"></script>
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/js__ENYUZMe5BHbMK8_pF3i18y1CtuMx_ItPRfjUOF7vUds__MXaxQPtP7z2LRCIe-IOxTRyNSvHNhJSb9SX1jpwq-Z8__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js" defer="defer"></script>
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/js__dTRSuW27RiJte-z_L4Px_rno5dZsdWKiU3HtuBiTSmc__1heMEGpuuHZnihe04BOr3X2vIc8bRMaEUwDqgCjyFsM__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js" defer="defer"></script>
<script type="text/javascript" defer="defer" async="async" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/analytics.js"></script>
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/js__gAfkvwHTHdM_vebZo2iTQLdnpDeigD9kUQ7XFOcxI1Y__G9O1Jd54B-E1iYd8UT-IVu_jRdw44oi8geXeCGkQUc0__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js" defer="defer" async="async"></script>
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/js__pLKQd4r7OrHglE7Qkqw53K2UXCqQdhqQ9v0cz7hMCQY__OErfYuQdGbFHcCoLoUW_ESSvaumApNojzjJit8-2xcw__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js" defer="defer"></script>
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/js__hHUWFbMAa11eJtx5V0ym9o0YBsB1udk34qUT5wr1ihI__v_laEepDqP2anEEp6ywEdbWv-xdkaC1VUNQ6A-wrXno__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js" defer="defer"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
function init_drupal_core_settings() {jQuery.extend(Drupal.settings,{"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"bluecheese","theme_token":"SdGfW9IQLbs3oZz-J3d5xQiUhSclae6l-rQbV1Ldz5c"},"colorbox":{"transition":"elastic","speed":"100","opacity":"0.85","slideshow":false,"slideshowAuto":true,"slideshowSpeed":"2500","slideshowStart":"start slideshow","slideshowStop":"stop slideshow","current":"{current} of {total}","previous":"\u00ab Prev","next":"Next \u00bb","close":"Close","overlayClose":true,"returnFocus":true,"maxWidth":"98%","maxHeight":"98%","initialWidth":"300","initialHeight":"250","fixed":true,"scrolling":true,"mobiledetect":true,"mobiledevicewidth":"480px"},"better_exposed_filters":{"views":{"documentation_related_content":{"displays":{"related_content_pane":{"filters":[]}}}}},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip","trackColorbox":1},"urlIsAjaxTrusted":{"\/docs\/7\/creating-custom-modules\/howtos\/examples-for-database-update-scripts-using-hook_update_n-how":true},"ogContext":{"groupType":"node","gid":"2804403"}}); 
if(jQuery.isFunction(jQuery.holdReady)){jQuery.holdReady(false);}} if(window.jQuery && window.Drupal){init_drupal_core_settings();}
//--><!]]>
</script>
<script type="text/javascript" src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/js__vj0LjvNwl-3K1P9LGT4BGuXCZcAovYsVlVmoJN3TMRg__KW8SiGceRY3sjIKVrffDjf2MK4A5Vp3EDDxVO-4pegI__YaNGWokqa69Wq8hHbkE322PVJ8I-GmpfBsT8LGsMpcI.js" defer="defer"></script>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"e671e25255","applicationID":"4266189","transactionName":"Z1AEbREHVxAFU0RRV14aJ1oXD1YNS15fXF1vRQdeBjlPCgFH","queueTime":0,"applicationTime":1224,"atts":"SxcHG1kdRB4=","errorBeacon":"bam.nr-data.net","agent":""}</script>

<div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious"></button><button type="button" id="cboxNext"></button><button type="button" id="cboxSlideshow"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none; max-width: none;"></div></div><script src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/saved_resource" type="text/javascript"></script><script src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/adsct" type="text/javascript"></script><script src="./Examples for database update scripts using hook_update_N (how to do one time configuration programmatically) _ Drupal 7 guide on Drupal.org_files/adsct(1)" type="text/javascript"></script></body></html>