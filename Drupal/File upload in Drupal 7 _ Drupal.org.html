<!DOCTYPE html>
<!-- saved from url=(0035)https://www.drupal.org/node/1537950 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr" xmlns:fb="http://ogp.me/ns/fb#" xmlns:og="http://ogp.me/ns#" xmlns:article="http://ogp.me/ns/article#" xmlns:book="http://ogp.me/ns/book#" xmlns:profile="http://ogp.me/ns/profile#" xmlns:video="http://ogp.me/ns/video#" xmlns:product="http://ogp.me/ns/product#" class="js"><head profile="http://www.w3.org/1999/xhtml/vocab"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="HandheldFriendly" content="true">
  <meta name="viewport" content="width=device-width">
  <meta name="MobileOptimized" content="width">
  <!--[if IE]><![endif]-->

<link rel="dns-prefetch" href="https://www.google-analytics.com/">
<link rel="preconnect" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://fonts.gstatic.com/">
<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
<link rel="preconnect" href="https://www.google-analytics.com/">
<link rel="preconnect" href="https://stats.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://stats.g.doubleclick.net/">
<meta name="description" content="Hi, How we can add the file upload field in Drupal 7 custom form.Once uploaded and submitted, the file is to be saved in /sites/all/default/file. Thanks">
<meta name="generator" content="Drupal 7 (http://drupal.org)">
<link rel="canonical" href="https://www.drupal.org/node/1537950">
<link rel="shortlink" href="https://www.drupal.org/node/1537950">
<meta property="og:site_name" content="Drupal.org">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.drupal.org/node/1537950">
<meta property="og:title" content="File upload in Drupal 7">
<meta property="og:description" content="Hi, How we can add the file upload field in Drupal 7 custom form.Once uploaded and submitted, the file is to be saved in /sites/all/default/file. Thanks">
<meta property="og:updated_time" content="2012-04-18T11:13:50+00:00">
<meta property="article:published_time" content="2012-04-18T09:47:27+00:00">
<meta property="article:modified_time" content="2012-04-18T11:13:50+00:00">
  <title>File upload in Drupal 7 | Drupal.org</title>
  <link type="text/css" rel="stylesheet" href="./File upload in Drupal 7 _ Drupal.org_files/css__F7qWzHu9exaCJEYsQHu4vlsmrwSsr-qGjQnU92OTBGg__HE-ON2wi0ZHmA1wJMd9l5pXEt1FafFXA2XQdUHDdRdE__zGbh0Vkd6-Upw_meABdy9qwehpIxfCh8fKwHkW793IE.css" media="all">
<link type="text/css" rel="stylesheet" href="./File upload in Drupal 7 _ Drupal.org_files/css__QPp1snPjYt_xYr0c_V0IORcEElkIUBBBrvOB4ZE0Gnw__3qF9PxPt19PkXVC_JpWxae-RR0F3QmrW0mhzzcQEnNY__zGbh0Vkd6-Upw_meABdy9qwehpIxfCh8fKwHkW793IE.css" media="all">
  <script type="text/javascript" async="" src="./File upload in Drupal 7 _ Drupal.org_files/54419274f6c96ed073000003.js"></script><script type="text/javascript">
<!--//--><![CDATA[//><!--
var preconnect_support = false; try {if (document.createElement("link").relList.supports("preconnect")) {preconnect_support = true;}} catch (e) {} if (!preconnect_support) { var prefetch = document.createElement("link"); prefetch.href = "https://stats.g.doubleclick.net/robots.txt"; prefetch.rel="prefetch"; document.getElementsByTagName("head")[0].appendChild(prefetch);}
//--><!]]>
</script>
<script type="text/javascript" async="" src="./File upload in Drupal 7 _ Drupal.org_files/tagjs"></script><img src="./File upload in Drupal 7 _ Drupal.org_files/saved_resource" width="1" height="1" border="0"><img src="./File upload in Drupal 7 _ Drupal.org_files/seg" width="1" height="1" border="0"><img src="./File upload in Drupal 7 _ Drupal.org_files/seg(1)" width="1" height="1" border="0"></head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-1537950 node-type-forum drupalorg-site-main no-panels-layout project-issue-focused-input-processed">
  <div id="skip-link">
    <a class="element-invisible element-focusable" href="https://www.drupal.org/node/1537950#content">Skip to main content</a>
    <a class="element-invisible element-focusable skip-link-search" href="https://www.drupal.org/node/1537950#search-block-form">Skip to search</a>
  </div>
        <div id="nav-header">
    <div class="menu-nav">
      <a class="nav-btn" id="nav-open-btn" href="https://www.drupal.org/node/1537950#block-system-main-menu"><img src="./File upload in Drupal 7 _ Drupal.org_files/icon-w-menu.svg" alt="Main menu"></a>
    </div>
    <nav id="navigation-inner" class="container-12" role="navigation">
        <div class="region region-navigation">
    <div id="block-system-main-menu" class="block block-system block-menu">
<div class="block-inner">
    
  <div class="content">
    <div class="menu-block"><ul class="menu"><li class="first leaf"><a href="https://www.drupal.org/home" title="Drupal.org home page">Drupal.org home</a></li>
<li class="leaf"><a href="https://www.drupal.org/download" title="Download and Extend Drupal">Download &amp; Extend</a></li>
<li class="leaf"><a href="https://www.drupal.org/community" title="Drupal Community">Community</a></li>
<li class="leaf"><a href="https://www.drupal.org/documentation" title="Drupal Documentation">Documentation</a></li>
<li class="leaf"><a href="https://www.drupal.org/support" title="Support for using Drupal">Support</a></li>
<li class="leaf"><a href="https://jobs.drupal.org/" title="Drupal Jobs">Jobs</a></li>
<li class="leaf"><a href="https://www.drupal.org/drupal-services" title="Buy Drupal Products and Services">Marketplace</a></li>
<li class="last leaf"><a href="https://www.drupal.org/about" title="">About</a></li>
</ul></div><a class="close-btn" id="nav-close-btn" href="https://www.drupal.org/node/1537950#top">Return to Content</a>  </div>
  </div>
</div>
<div id="block-search-form" class="block block-search">
<div class="block-inner">
    
  <div class="content">
    <form action="https://www.drupal.org/node/1537950" method="post" id="search-block-form" accept-charset="UTF-8"><div><div class="container-inline">
      <h2 class="element-invisible">Search form</h2>
    <div class="form-item form-type-textfield form-item-search-block-form">
  <label class="element-invisible" for="edit-search-block-form--2">Search </label>
 <input placeholder="Search…" type="text" id="edit-search-block-form--2" name="search_block_form" value="" size="15" maxlength="128" class="form-text">
</div>
<div class="form-actions form-wrapper" id="edit-actions"><input alt="Search" type="image" id="edit-submit" name="submit" value="Search" src="./File upload in Drupal 7 _ Drupal.org_files/icon-w-search.svg" class="form-submit"></div><input type="hidden" name="form_build_id" value="form-liyhieMIaR5EoHpq1a7eRkmxTNvtwXSVT7pdFEa7iO4">
<input type="hidden" name="form_id" value="search_block_form">
</div>
</div></form>  </div>
  </div>
</div>
<div id="block-system-user-menu" class="block block-system block-menu">
<div class="block-inner">
    
  <div class="content">
    <div class="menu-block"><ul class="menu"><li class="button default"><a href="https://www.drupal.org/node/1537950#block-system-user-menu"><img src="./File upload in Drupal 7 _ Drupal.org_files/icon-w-user.svg" alt="Log in, view profile, and more"></a><ul><li class="first leaf"><a href="https://www.drupal.org/user/login?destination=node/1537950" title="">Log in</a></li>
<li class="last leaf"><a href="https://www.drupal.org/user/register?destination=node/1537950" title="">Create account</a></li>
</ul></li></ul></div>  </div>
  </div>
</div>
  </div>
    </nav>
  </div> <!-- /#nav-header -->

    <div id="header" class="clearfix">
    <div id="header-screen" class="clearfix">
      <div id="header-inner" class="container-12 clearfix">
        <div id="header-content">
          <div id="header-left">
            <div id="header-left-inner">
              <div id="site-name"><a href="https://www.drupal.org/" title="Drupal"><img src="./File upload in Drupal 7 _ Drupal.org_files/drupal-wordmark.svg" alt="Drupal"></a></div>
                          </div> <!-- /#header-left-inner -->
          </div> <!-- /#header-left -->

          <div id="header-right">
            <div id="header-right-inner" role="search">
                          </div> <!-- /#header-right-inner -->
          </div> <!-- /#header-right -->
        </div> <!-- /#header-content -->
      </div> <!-- /#header-inner -->
    </div>
  </div> <!-- /#header -->
  
  
  <div id="page" class="clearfix">
    <div id="page-heading">
                    <div id="page-title-tools" class="container-12 clearfix" role="navigation">

          <div class="page-title-wrapper">
                                          <div id="page-title" class="h2">Community</div>
                                    </div>

                  </div> <!-- /#page-title-tools -->

                  <div id="nav-content" class="container-12">
            <ul class="links"><li class="home first"><a href="https://www.drupal.org/community">Community Home</a></li>
<li class="getting-involved"><a href="https://www.drupal.org/getting-involved">Getting Involved</a></li>
<li class="chat"><a href="https://www.drupal.org/irc">Chat</a></li>
<li class="forum active last"><a href="https://www.drupal.org/forum" class="active">Forum</a></li>
</ul>          </div> <!-- /#nav-content -->
        
        <div class="breadbox"><nav class="breadcrumb container-12"><span><a href="https://www.drupal.org/forum/18">Support</a></span><span><a href="https://www.drupal.org/forum/22">Post installation</a></span></nav></div>

                  <h1 id="page-subtitle" class="container-12">File upload in Drupal 7</h1>
        
      
    </div> <!-- /#page-heading -->

    
    <div class="container-12 page-inner">      
      <div id="main" role="main">
        
        <div id="content" class="clearfix">
                                        <div id="content-inner" class="clearfix">  <div class="region region-content">
    <div id="block-system-main" class="block block-system">
<div class="block-inner">
    
  <div class="content">
    <div id="node-1537950" class="node node-forum node-content-1537950 clearfix">

  
      
      <div class="submitted">
      Posted by <a href="https://www.drupal.org/u/manoj_j" title="View user profile." data-uid="952230" class="username">manoj_j</a> on <time pubdate="" datetime="1334742447">18 Apr 2012 at 09:47 UTC</time>    </div>
  
  <div class="content">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><p>Hi,</p>
<p>How we can add the file upload field in Drupal 7 custom form.Once uploaded and submitted, the file is to be saved in /sites/all/default/file.</p>
<p>Thanks</p></div></div></div>  </div>

  <div class="node-footer"><ul class="links inline"><li class="comment_forbidden first last"><span><a href="https://www.drupal.org/user/login?destination=comment/reply/1537950%23comment-form">Log in</a> or <a href="https://www.drupal.org/user/register?destination=comment/reply/1537950%23comment-form">register</a> to post comments</span></li>
</ul><span class="separator">⋅</span> <span class="terms">Categories: <a href="https://www.drupal.org/taxonomy/term/120">Drupal 7.x</a></span></div>

</div>

<section class="comments comment-wrapper timeago-processed">
          <h2 class="title">Comments</h2>
      
  <a id="comment-5885702"></a>
<div class="comment comment-content-5885702 clearfix">
  <a href="https://www.drupal.org/u/web-assistant" title="View user profile." class="picture"><img src="./File upload in Drupal 7 _ Drupal.org_files/default-avatar.png" width="80" height="80" alt="Web Assistant’s picture"></a>
  
    <h3><a href="https://www.drupal.org/node/1537950#comment-5885702" class="permalink active" rel="bookmark">Can I recommend looking at</a></h3>
  
  <div class="submitted">
        <a href="https://www.drupal.org/u/web-assistant" title="View user profile." data-uid="368931" class="username">Web Assistant</a> commented <time pubdate="" datetime="2012-04-18T11:26:53+00:00" data-created-date="18 April 2012 at 11:26" title="18 April 2012 at 11:26 (click to toggle)">5 years ago</time>  </div>

  <div class="content">
    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Can I recommend looking at the <a href="http://drupal.org/project/examples" rel="nofollow">examples module</a>. If you look at the last tutorial on forms, it shows how to upload a file, validate, and save.</p>
<p><a href="http://api.drupal.org/api/examples/form_example!form_example_tutorial.inc/function/form_example_tutorial_10/7" rel="nofollow">form_example_tutorial_10</a></p></div></div></div>      </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="https://www.drupal.org/user/login?destination=comment/reply/1537950%23comment-form">Log in</a> or <a href="https://www.drupal.org/user/register?destination=comment/reply/1537950%23comment-form">register</a> to post comments</span></li>
</ul></div>

<div class="indented"><a id="comment-5885958"></a>
<div class="comment comment-by-node-author comment-content-5885958 clearfix">
  <a href="https://www.drupal.org/u/manoj_j" title="View user profile." class="picture"><img src="./File upload in Drupal 7 _ Drupal.org_files/default-avatar.png" width="80" height="80" alt="manoj_j’s picture"></a>
  
    <h3><a href="https://www.drupal.org/node/1537950#comment-5885958" class="permalink active" rel="bookmark">Hi I tried the code in</a></h3>
  
  <div class="submitted">
        <a href="https://www.drupal.org/u/manoj_j" title="View user profile." data-uid="952230" class="username">manoj_j</a> commented <time pubdate="" datetime="2012-04-18T12:43:31+00:00" data-created-date="18 April 2012 at 12:43" title="18 April 2012 at 12:43 (click to toggle)">5 years ago</time>  </div>

  <div class="content">
    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Hi I tried the code in form_example_tutorial_10</p>
<p>the file was uploaded in the "files" folder inside default.But this error is showing up:</p>
<p>  Notice: Undefined property: stdClass::$uri in file_save() (line 575 of includes\file.inc).</p>
<p>  PDOException: SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '' for key 'uri': INSERT INTO {file_managed} (filesize, status, timestamp) VALUES (:db_insert_placeholder_0, :db_insert_placeholder_1, :db_insert_placeholder_2); Array ( [:db_insert_placeholder_0] =&gt; 0 [:db_insert_placeholder_1] =&gt; 1 [:db_insert_placeholder_2] =&gt; 1334752869 ) in drupal_write_record() (line 6776 of includes\common.inc).</p>
<p>Can you please advice?</p></div></div></div>      </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="https://www.drupal.org/user/login?destination=comment/reply/1537950%23comment-form">Log in</a> or <a href="https://www.drupal.org/user/register?destination=comment/reply/1537950%23comment-form">register</a> to post comments</span></li>
</ul></div>

<div class="indented"><a id="comment-5886204"></a>
<div class="comment comment-content-5886204 clearfix">
  <a href="https://www.drupal.org/u/web-assistant" title="View user profile." class="picture"><img src="./File upload in Drupal 7 _ Drupal.org_files/default-avatar.png" width="80" height="80" alt="Web Assistant’s picture"></a>
  
    <h3><a href="https://www.drupal.org/node/1537950#comment-5886204" class="permalink active" rel="bookmark">Can you show your code?</a></h3>
  
  <div class="submitted">
        <a href="https://www.drupal.org/u/web-assistant" title="View user profile." data-uid="368931" class="username">Web Assistant</a> commented <time pubdate="" datetime="2012-04-18T22:09:21+00:00" data-created-date="18 April 2012 at 22:09" title="18 April 2012 at 22:09 (click to toggle)">5 years ago</time>  </div>

  <div class="content">
    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Can you show your code? </p>
<p>From the error message it seems you are putting the uri into file_save(), but you should be using the file object instead.</p></div></div></div>      </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="https://www.drupal.org/user/login?destination=comment/reply/1537950%23comment-form">Log in</a> or <a href="https://www.drupal.org/user/register?destination=comment/reply/1537950%23comment-form">register</a> to post comments</span></li>
</ul></div>

<div class="indented"><a id="comment-5889558"></a>
<div class="comment comment-by-node-author comment-content-5889558 clearfix">
  <a href="https://www.drupal.org/u/manoj_j" title="View user profile." class="picture"><img src="./File upload in Drupal 7 _ Drupal.org_files/default-avatar.png" width="80" height="80" alt="manoj_j’s picture"></a>
  
    <h3><a href="https://www.drupal.org/node/1537950#comment-5889558" class="permalink active" rel="bookmark">Here it is:under hook_menu:</a></h3>
  
  <div class="submitted">
        <a href="https://www.drupal.org/u/manoj_j" title="View user profile." data-uid="952230" class="username">manoj_j</a> commented <time pubdate="" datetime="2012-04-19T06:26:53+00:00" data-created-date="19 April 2012 at 06:26" title="19 April 2012 at 06:26 (click to toggle)">5 years ago</time>  </div>

  <div class="content">
    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Here it is:</p>
<p><strong>under hook_menu:</strong></p>
<p> $form['file'] = array(<br>
    '#type' =&gt; 'file',<br>
    '#title' =&gt; t('Image'),<br>
    '#description' =&gt; t('Upload a file, allowed extensions: jpg, jpeg, png, gif'),<br>
  );</p>
<p><strong>under hook_validation:</strong></p>
<p> $file = file_save_upload('file', array(<br>
    'file_validate_is_image' =&gt; array(),<br>
    'file_validate_extensions' =&gt; array('png gif jpg jpeg'),<br>
  ));<br>
  if ($file) {<br>
        if ($file = file_move($file, 'public://')) {<br>
        $form_state['values']['file'] = $file;<br>
    }<br>
    else {<br>
      form_set_error('file', t('Failed to write the uploaded file the site\'s file folder.'));<br>
    }<br>
  }<br>
  else {<br>
    form_set_error('file', t('No file was uploaded.'));<br>
  }<br>
}</p>
<p><strong>under hook_submit:</strong></p>
<p> $file=$form_state['values']['file'];<br>
 unset($form_state['values']['file']);<br>
  $file-&gt;status = FILE_STATUS_PERMANENT;<br>
  file_save($file);<br>
 drupal_set_message(t('The form has been submitted and the image has been saved, filename: @filename.', array('@filename' =&gt; $file-&gt;filename)));</p></div></div></div>      </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="https://www.drupal.org/user/login?destination=comment/reply/1537950%23comment-form">Log in</a> or <a href="https://www.drupal.org/user/register?destination=comment/reply/1537950%23comment-form">register</a> to post comments</span></li>
</ul></div>

<div class="indented"><a id="comment-5889794"></a>
<div class="comment comment-content-5889794 clearfix">
  <a href="https://www.drupal.org/u/web-assistant" title="View user profile." class="picture"><img src="./File upload in Drupal 7 _ Drupal.org_files/default-avatar.png" width="80" height="80" alt="Web Assistant’s picture"></a>
  
    <h3><a href="https://www.drupal.org/node/1537950#comment-5889794" class="permalink active" rel="bookmark">Works fine for</a></h3>
  
  <div class="submitted">
        <a href="https://www.drupal.org/u/web-assistant" title="View user profile." data-uid="368931" class="username">Web Assistant</a> commented <time pubdate="" datetime="2012-04-19T07:47:37+00:00" data-created-date="19 April 2012 at 07:47" title="19 April 2012 at 07:47 (click to toggle)">5 years ago</time>  </div>

  <div class="content">
    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Works fine for me.</p>
<pre class="codeblock language-php"><code class=" language-php"><span class="token php"><span class="token delimiter">&lt;?php</span>
<span class="token keyword keyword-function">function</span> <span class="token function">test_menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$items</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token variable">$items</span><span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'test'</span><span class="token punctuation">,</span>
    <span class="token string">'page callback'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'drupal_get_form'</span><span class="token punctuation">,</span>
    <span class="token string">'page arguments'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'testform'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'access callback'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">TRUE</span><span class="token punctuation">,</span>
    <span class="token string">'type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">MENU_CALLBACK</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-return">return</span> <span class="token variable">$items</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-function">function</span> <span class="token function">testform</span><span class="token punctuation">(</span><span class="token variable">$form</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$form_state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$form</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$form</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    	<span class="token string">'#type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'file'</span><span class="token punctuation">,</span>
    	<span class="token string">'#title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Image'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    	<span class="token string">'#description'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Upload a file, allowed extensions: jpg, jpeg, png, gif'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$form</span><span class="token punctuation">[</span><span class="token string">'submit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
    <span class="token string">'#type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'submit'</span><span class="token punctuation">,</span>
    <span class="token string">'#value'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Submit'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword keyword-return">return</span> <span class="token variable">$form</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-function">function</span> <span class="token function">testform_validate</span><span class="token punctuation">(</span><span class="token variable">$form</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$form_state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">file_save_upload</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
  	<span class="token string">'file_validate_is_image'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  	<span class="token string">'file_validate_extensions'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'png gif jpg jpeg'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">file_move</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string">'public://'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token variable">$form_state</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
      <span class="token function">form_set_error</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Failed to write the uploaded file the site\'s file folder.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
    <span class="token function">form_set_error</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'No file was uploaded.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-function">function</span> <span class="token function">testform_submit</span><span class="token punctuation">(</span><span class="token variable">$form</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$form_state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$form_state</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token function">unset</span><span class="token punctuation">(</span><span class="token variable">$form_state</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">status</span> <span class="token operator">=</span> <span class="token constant">FILE_STATUS_PERMANENT</span><span class="token punctuation">;</span>
  <span class="token function">file_save</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">drupal_set_message</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'The form has been submitted and the image has been saved, filename: @filename.'</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'@filename'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token delimiter">?&gt;</span></span></code></pre></div></div></div>      </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="https://www.drupal.org/user/login?destination=comment/reply/1537950%23comment-form">Log in</a> or <a href="https://www.drupal.org/user/register?destination=comment/reply/1537950%23comment-form">register</a> to post comments</span></li>
</ul></div>

<div class="indented"><a id="comment-5889854"></a>
<div class="comment comment-by-node-author comment-content-5889854 clearfix">
  <a href="https://www.drupal.org/u/manoj_j" title="View user profile." class="picture"><img src="./File upload in Drupal 7 _ Drupal.org_files/default-avatar.png" width="80" height="80" alt="manoj_j’s picture"></a>
  
    <h3><a href="https://www.drupal.org/node/1537950#comment-5889854" class="permalink active" rel="bookmark">Thanks It worked !</a></h3>
  
  <div class="submitted">
        <a href="https://www.drupal.org/u/manoj_j" title="View user profile." data-uid="952230" class="username">manoj_j</a> commented <time pubdate="" datetime="2012-04-19T08:15:02+00:00" data-created-date="19 April 2012 at 08:15" title="19 April 2012 at 08:15 (click to toggle)">5 years ago</time>  </div>

  <div class="content">
    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><p>Thanks It worked !</p></div></div></div>      </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="https://www.drupal.org/user/login?destination=comment/reply/1537950%23comment-form">Log in</a> or <a href="https://www.drupal.org/user/register?destination=comment/reply/1537950%23comment-form">register</a> to post comments</span></li>
</ul></div>
</div></div></div></div></div><a id="comment-6835896"></a>
<div class="comment comment-content-6835896 clearfix">
  <a href="https://www.drupal.org/user/1821568" title="View user profile." class="picture"><img src="./File upload in Drupal 7 _ Drupal.org_files/default-avatar.png" width="80" height="80" alt="ajf7688’s picture"></a>
  
    <h3><a href="https://www.drupal.org/node/1537950#comment-6835896" class="permalink active" rel="bookmark">Multiple Files to Multiple Nodes</a></h3>
  
  <div class="submitted">
        <a href="https://www.drupal.org/user/1821568" title="View user profile." data-uid="1821568" class="username">ajf7688</a> commented <time pubdate="" datetime="2012-12-12T06:19:29+00:00" data-created-date="12 December 2012 at 06:19" title="12 December 2012 at 06:19 (click to toggle)">5 years ago</time>  </div>

  <div class="content">
    <div class="field field-name-comment-body field-type-text-long field-label-hidden"><div class="field-items"><div class="field-item even"><pre class="codeblock language-php"><code class=" language-php"><span class="token php"><span class="token delimiter">&lt;?php</span>
<span class="token keyword keyword-function">function</span> <span class="token function">ajf_multiple_portfolio_images_form</span><span class="token punctuation">(</span><span class="token variable">$form</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$form_state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$form</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token variable">$form</span><span class="token punctuation">[</span><span class="token string">'photos'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
        <span class="token string">'#type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'file'</span><span class="token punctuation">,</span>
        <span class="token string">'#name'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'files[]'</span><span class="token punctuation">,</span>
        <span class="token string">'#title'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Upload some photos'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'#description'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'JPG\'s, GIF\'s, and PNG\'s only, 10MB Max Size'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'#attributes'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'multiple'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'multiple'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token variable">$form</span><span class="token punctuation">[</span><span class="token string">'submit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
        <span class="token string">'#type'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'submit'</span><span class="token punctuation">,</span>
        <span class="token string">'#value'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Upload'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword keyword-return">return</span> <span class="token variable">$form</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-function">function</span> <span class="token function">ajf_multiple_portfolio_images_form_validate</span><span class="token punctuation">(</span><span class="token variable">$form</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$form_state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
    <span class="token variable">$num_files</span> <span class="token operator">=</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token global">$_FILES</span><span class="token punctuation">[</span><span class="token string">'files'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword keyword-for">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$num_files</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">file_save_upload</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">,</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span>
            <span class="token string">'file_validate_is_image'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">'file_validate_extensions'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token string">'png gif jpg jpeg'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">file_move</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string">'public://'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token variable">$form_state</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'photos'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
          <span class="token function">form_set_error</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'Failed to write the uploaded file the site\'s file folder.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword keyword-else">else</span> <span class="token punctuation">{</span>
        <span class="token function">form_set_error</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token function">t</span><span class="token punctuation">(</span><span class="token string">'No file was uploaded.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>    
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword keyword-function">function</span> <span class="token function">ajf_multiple_portfolio_images_form_submit</span><span class="token punctuation">(</span><span class="token variable">$form</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$form_state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
    <span class="token variable">$count</span> <span class="token operator">=</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$form_state</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'photos'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$form_state</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'photos'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword keyword-foreach">foreach</span> <span class="token punctuation">(</span><span class="token variable">$form_state</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'photos'</span><span class="token punctuation">]</span> <span class="token keyword keyword-as">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword keyword-global">global</span> <span class="token variable">$user</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span> <span class="token operator">=</span> <span class="token keyword keyword-new">new</span> <span class="token class-name">stdClass</span><span class="token punctuation">;</span>
            <span class="token variable">$file_info</span> <span class="token operator">=</span> <span class="token function">image_get_info</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">uri</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">type</span> <span class="token operator">=</span> <span class="token string">'photo'</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">title</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">filename</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'fid'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">fid</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'alt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">filename</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">filename</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'width'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file_info</span><span class="token punctuation">[</span><span class="token string">'width'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file_info</span><span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'uid'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">uid</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'filename'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">filename</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'uri'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">uri</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'filemime'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">filemime</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'filesize'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">filesize</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'status'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">timestamp</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">field_image</span><span class="token punctuation">[</span><span class="token constant">LANGUAGE_NONE</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'rdf_mapping'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-array">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">uid</span> <span class="token operator">=</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">uid</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">status</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token variable">$node</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">active</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token function">node_save</span><span class="token punctuation">(</span><span class="token variable">$node</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">drupal_set_message</span><span class="token punctuation">(</span><span class="token function">t</span><span class="token punctuation">(</span><span class="token string">"You have uploaded $count photos"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token delimiter">?&gt;</span></span>
</code></pre></div></div></div>      </div>

  <ul class="links inline"><li class="comment_forbidden first last"><span><a href="https://www.drupal.org/user/login?destination=comment/reply/1537950%23comment-form">Log in</a> or <a href="https://www.drupal.org/user/register?destination=comment/reply/1537950%23comment-form">register</a> to post comments</span></li>
</ul></div>

  </section>
  </div>
  </div>
</div>
  </div>
</div>
                  </div> <!-- /#content -->

      </div> <!-- /#column-left -->

      
          </div>  </div> <!-- /#page -->

  <div id="footer" role="contentinfo">
            <div class="region region-footer">
    <div id="block-drupalorg-crosssite-drupalorg-footer" class="block block-drupalorg-crosssite">
<div class="block-inner">
    
  <div class="content">
    <h4 class="element-invisible">News items</h4><ul class="drupal-news"><li class="0 first"><a href="https://www.drupal.org/news">News</a></li>
<li class="1"><a href="https://www.drupal.org/planet" title="News from Drupal community members">Planet Drupal</a></li>
<li class="2"><a href="https://www.drupal.org/social-media" title="Drupal on social media">Social media directory</a></li>
<li class="3"><a href="https://www.drupal.org/security" title="Advisories from the security team">Security announcements</a></li>
<li class="4 last"><a href="https://jobs.drupal.org/" title="Drupal Jobs">Jobs</a></li>
</ul><h4 class="element-invisible">Our community</h4><ul class="community"><li class="0 first"><a href="https://drupal.org/community">Community</a></li>
<li class="1"><a href="https://drupal.org/getting-involved" title="Learn how to contribute to the Drupal project">Getting involved</a></li>
<li class="2"><span><a href="https://drupal.org/drupal-services" title="People and organizations offering Drupal services">Services</a>, <a href="https://drupal.org/training" title="People and organizations offering Drupal training">Training</a> &amp; <a href="https://drupal.org/hosting" title="Organizations offering Drupal hosting">Hosting</a></span></li>
<li class="3"><a href="https://groups.drupal.org/groups" title="groups.drupal.org">Groups &amp; Meetups</a></li>
<li class="4"><a href="https://events.drupal.org/" title="Upcoming and past DrupalCons">DrupalCon</a></li>
<li class="5 last"><a href="https://drupal.org/dcoc" title="Drupal code of conduct">Code of conduct</a></li>
</ul><h4 class="element-invisible">Documentation</h4><ul class="get-started"><li class="0 first"><a href="https://drupal.org/documentation" title="Documentation for working with Drupal">Documentation</a></li>
<li class="1"><a href="https://www.drupal.org/docs/8">Drupal 8 docs</a></li>
<li class="2"><a href="https://www.drupal.org/docs/7">Drupal 7 docs</a></li>
<li class="3"><a href="https://www.drupal.org/documentation/develop">Developer docs</a></li>
<li class="4 last"><a href="https://api.drupal.org/" title="Drupal API reference">api.drupal.org</a></li>
</ul><h4 class="element-invisible">Drupal code base</h4><ul class="download-extend"><li class="0 first"><a href="https://drupal.org/download">Download &amp; Extend</a></li>
<li class="1"><a href="https://drupal.org/project/drupal" title="Download the latest version of the Drupal software">Drupal core</a></li>
<li class="2"><a href="https://drupal.org/project/project_module" title="Download add-on features and functionality">Modules</a></li>
<li class="3"><a href="https://drupal.org/project/project_theme" title="Download pre-designed styles for Drupal">Themes</a></li>
<li class="4 last"><a href="https://drupal.org/project/project_distribution" title="Download a pre-packaged Drupal site">Distributions</a></li>
</ul><h4 class="element-invisible">Governance of community</h4><ul class="about"><li class="0 first"><a href="https://drupal.org/about">About</a></li>
<li class="1"><a href="https://drupal.org/about/accessibility" title="Our committment to accessibility">Web accessibility</a></li>
<li class="2"><a href="https://drupal.org/association" title="About the Drupal Association">The Drupal Association</a></li>
<li class="3"><a href="https://drupal.org/drupalorg" title="About Drupal.org">About Drupal.org</a></li>
<li class="4"><a href="https://drupal.org/terms" title="Drupal.org terms of service">Terms of service</a></li>
<li class="5 last"><a href="https://drupal.org/privacy" title="Drupal.org privacy policy">Privacy policy</a></li>
</ul>  </div>
  </div>
</div>
<div id="block-block-77" class="block block-block">
<div class="block-inner">
    
  <div class="content">
    <p>Drupal is a <a href="http://drupal.com/trademark" rel="nofollow">registered trademark</a> of <a href="http://buytaert.net/" rel="nofollow">Dries Buytaert</a>.</p>  </div>
  </div>
</div>
  </div>
      </div>
  
<!--[if lte IE 9]>
<script type="text/javascript" src="https://www.drupal.org/files/advagg_js/js__79M6UrZjAw3oNGnUjsWip12JsvnUZmJGA3h9LI0kuzE__LqE6uSZqCOZhJYW910TDw_HTQzBKUPTZxunfaWkalq8__zGbh0Vkd6-Upw_meABdy9qwehpIxfCh8fKwHkW793IE.js#ie9-" onload="if(jQuery.isFunction(jQuery.holdReady)){jQuery.holdReady(true);}"></script>
<![endif]-->

<!--[if gt IE 9]>
<script type="text/javascript" src="https://www.drupal.org/files/advagg_js/js__79M6UrZjAw3oNGnUjsWip12JsvnUZmJGA3h9LI0kuzE__LqE6uSZqCOZhJYW910TDw_HTQzBKUPTZxunfaWkalq8__zGbh0Vkd6-Upw_meABdy9qwehpIxfCh8fKwHkW793IE.js#ie10+" defer="defer" onload="if(jQuery.isFunction(jQuery.holdReady)){jQuery.holdReady(true);}"></script>
<![endif]-->

<!--[if !IE]><!-->
<script type="text/javascript" src="./File upload in Drupal 7 _ Drupal.org_files/js__79M6UrZjAw3oNGnUjsWip12JsvnUZmJGA3h9LI0kuzE__LqE6uSZqCOZhJYW910TDw_HTQzBKUPTZxunfaWkalq8__zGbh0Vkd6-Upw_meABdy9qwehpIxfCh8fKwHkW793IE.js" defer="defer" onload="if(jQuery.isFunction(jQuery.holdReady)){jQuery.holdReady(true);}"></script>
<!--<![endif]-->
<script type="text/javascript" src="./File upload in Drupal 7 _ Drupal.org_files/js__H5AFmq1RrXKsrazzPq_xPQPy4K0wUKqecPjczzRiTgQ__ZHqvWr-79k4Y5DRTd0KcuNHgFp9UJZlb3B0Bi5eGu3M__zGbh0Vkd6-Upw_meABdy9qwehpIxfCh8fKwHkW793IE.js" defer="defer" onload="
function advagg_mod_1() {
  // Count how many times this function is called.
  advagg_mod_1.count = ++advagg_mod_1.count || 1;
  try {
    if (advagg_mod_1.count &lt;= 40) {
      init_drupal_core_settings();

      // Set this to 100 so that this function only runs once.
      advagg_mod_1.count = 100;
    }
  }
  catch(e) {
    if (advagg_mod_1.count &gt;= 40) {
      // Throw the exception if this still fails after running 40 times.
      throw e;
    }
    else {
      // Try again in 1 ms.
      window.setTimeout(advagg_mod_1, 1);
    }
  }
}
function advagg_mod_1_check() {
  if (window.init_drupal_core_settings &amp;&amp; window.jQuery &amp;&amp; window.Drupal) {
    advagg_mod_1();
  }
  else {
    window.setTimeout(advagg_mod_1_check, 1);
  }
}
advagg_mod_1_check();"></script>
<script type="text/javascript" src="./File upload in Drupal 7 _ Drupal.org_files/js__y-0WF9wbsKup6UtG11ZtdWgidCFrAqzehETdOPtD3QM__LyuAxUNiVV0aTeQ6yCz3raaZRgDHi84llpu8a4LvXWc__zGbh0Vkd6-Upw_meABdy9qwehpIxfCh8fKwHkW793IE.js" defer="defer"></script>
<script type="text/javascript" defer="defer" async="async" src="./File upload in Drupal 7 _ Drupal.org_files/analytics.js"></script>
<script type="text/javascript" src="./File upload in Drupal 7 _ Drupal.org_files/js__hHUWFbMAa11eJtx5V0ym9o0YBsB1udk34qUT5wr1ihI__w1AuxI-Is3CtQ1nu9fAoIO4cMrl8j5oxHT1ffMU00Zo__zGbh0Vkd6-Upw_meABdy9qwehpIxfCh8fKwHkW793IE.js" defer="defer"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create", "UA-2360451-1", {"cookieDomain":"auto"});ga("set", "dimension3", "anonymous user");ga("set", "dimension4", "Forum topic");ga("set", "dimension1", "Post installation");ga("set", "dimension2", "community");ga("send", "pageview");
//--><!]]>
</script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
function init_drupal_core_settings() {jQuery.extend(Drupal.settings,{"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"bluecheese","theme_token":"8CtTgW3RIppJas7K_IE2DKYvcxoIz0FkLorRP-jekpw"},"jcarousel":{"ajaxPath":"\/jcarousel\/ajax\/views"},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc(x|m)?|dot(x|m)?|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt(x|m)?|pot(x|m)?|pps(x|m)?|ppam|sld(x|m)?|thmx|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls(x|m|b)?|xlt(x|m)|xlam|xml|z|zip"},"urlIsAjaxTrusted":{"\/node\/1537950":true}});
if(jQuery.isFunction(jQuery.holdReady)){jQuery.holdReady(false);}} if(window.jQuery && window.Drupal){init_drupal_core_settings();}
//--><!]]>
</script>
<script type="text/javascript" src="./File upload in Drupal 7 _ Drupal.org_files/js__to4E6ed7qbWQIIrZ8SjAf2iDoY3ZkHhlZySO3qQI4ws__30g4_YLNJDK0tUDy1vJDyqtAnbRAen2hxqieAjRIb3Q__zGbh0Vkd6-Upw_meABdy9qwehpIxfCh8fKwHkW793IE.js" defer="defer"></script>


</body></html>